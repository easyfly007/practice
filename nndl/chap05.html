<!DOCTYPE html>
<!-- saved from url=(0051)http://neuralnetworksanddeeplearning.com/chap5.html -->
<html lang="en"><!-- Produced from a LaTeX source file.  Note that the production is done --><!-- by a very rough-and-ready (and buggy) script, so the HTML and other  --><!-- code is quite ugly!  Later versions should be better.                --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="citation_title" content="Neural Networks and Deep Learning">
    <meta name="citation_author" content="Nielsen, Michael A.">
    <meta name="citation_publication_date" content="2015">
    <meta name="citation_fulltext_html_url" content="http://neuralnetworksanddeeplearning.com">
    <meta name="citation_publisher" content="Determination Press">
    <link rel="icon" href="http://neuralnetworksanddeeplearning.com/nnadl_favicon.ICO">
    <title>Neural networks and deep learning</title>
    <script async="" src="./chap05_files/analytics.js.download"></script><script src="./chap05_files/jquery.min.js.download"></script>
    <script type="text/x-mathjax-config;executed=true">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$']]},
        "HTML-CSS": 
          {scale: 92},
        TeX: { equationNumbers: { autoNumber: "AMS" }}});
    </script>
    <script type="text/javascript" src="./chap05_files/MathJax.js.download"></script>


    <link href="./chap05_files/style.css" rel="stylesheet">
    <link href="./chap05_files/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="./chap05_files/jquery-ui.css">

<style>
/* Adapted from */
/* https://groups.google.com/d/msg/mathjax-users/jqQxrmeG48o/oAaivLgLN90J, */
/* by David Cervone */

@font-face {
    font-family: 'MJX_Math';
    src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); /* IE9 Compat Modes */
    src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot?iefix') format('eot'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff')  format('woff'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf')  format('opentype'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Math-Italic.svg#MathJax_Math-Italic') format('svg');
}

@font-face {
    font-family: 'MJX_Main';
    src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); /* IE9 Compat Modes */
    src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot?iefix') format('eot'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff')  format('woff'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf')  format('opentype'),
    url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Main-Regular.svg#MathJax_Main-Regular') format('svg');
}
</style>

  <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.0') format('opentype')}
</style></head>
  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div><div class="header"><h1 class="chapter_number">
  <a href="http://neuralnetworksanddeeplearning.com/chap5.html">CHAPTER 5</a></h1>
  <h1 class="chapter_title"><a href="http://neuralnetworksanddeeplearning.com/chap5.html">Why are deep neural networks hard to train?</a></h1></div><div class="section"><div id="toc"> 
<p class="toc_title"><a href="http://neuralnetworksanddeeplearning.com/index.html">Neural Networks and Deep Learning</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/about.html">What this book is about</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/exercises_and_problems.html">On the exercises and problems</a></p><p class="toc_mainchapter"><a id="toc_using_neural_nets_to_recognize_handwritten_digits_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_using_neural_nets_to_recognize_handwritten_digits" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html">Using neural nets to recognize handwritten digits</a></p><div id="toc_using_neural_nets_to_recognize_handwritten_digits" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons"><li>Perceptrons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons"><li>Sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#the_architecture_of_neural_networks"><li>The architecture of neural networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#a_simple_network_to_classify_handwritten_digits"><li>A simple network to classify handwritten digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent"><li>Learning with gradient descent</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits"><li>Implementing our network to classify digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#toward_deep_learning"><li>Toward deep learning</li></a></ul><p></p></div>
<script>
$('#toc_using_neural_nets_to_recognize_handwritten_digits_reveal').click(function() { 
   var src = $('#toc_img_using_neural_nets_to_recognize_handwritten_digits').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow.png');
   };
   $('#toc_using_neural_nets_to_recognize_handwritten_digits').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_how_the_backpropagation_algorithm_works_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_how_the_backpropagation_algorithm_works" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html">How the backpropagation algorithm works</a></p><div id="toc_how_the_backpropagation_algorithm_works" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap2.html#warm_up_a_fast_matrix-based_approach_to_computing_the_output_from_a_neural_network"><li>Warm up: a fast matrix-based approach to computing the output
  from a neural network</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_two_assumptions_we_need_about_the_cost_function"><li>The two assumptions we need about the cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_hadamard_product_$s_\odot_t$"><li>The Hadamard product, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.375em 1002.06em 2.404em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.248em;">⊙</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.148em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>⊙</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">s \odot t</script></li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation"><li>The four fundamental equations behind backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#proof_of_the_four_fundamental_equations_(optional)"><li>Proof of the four fundamental equations (optional)</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_backpropagation_algorithm"><li>The backpropagation algorithm</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_code_for_backpropagation"><li>The code for backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#in_what_sense_is_backpropagation_a_fast_algorithm"><li>In what sense is backpropagation a fast algorithm?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#backpropagation_the_big_picture"><li>Backpropagation: the big picture</li></a></ul><p></p></div>
<script>
$('#toc_how_the_backpropagation_algorithm_works_reveal').click(function() { 
   var src = $('#toc_img_how_the_backpropagation_algorithm_works').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow.png');
   };
   $('#toc_how_the_backpropagation_algorithm_works').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_improving_the_way_neural_networks_learn_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_improving_the_way_neural_networks_learn" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html">Improving the way neural networks learn</a></p><div id="toc_improving_the_way_neural_networks_learn" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function"><li>The cross-entropy cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization"><li>Overfitting and regularization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization"><li>Weight initialization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code"><li>Handwriting recognition revisited: the code</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network&#39;s_hyper-parameters"><li>How to choose a neural network's hyper-parameters?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques"><li>Other techniques</li></a></ul><p></p></div>
<script>
$('#toc_improving_the_way_neural_networks_learn_reveal').click(function() { 
   var src = $('#toc_img_improving_the_way_neural_networks_learn').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow.png');
   };
   $('#toc_improving_the_way_neural_networks_learn').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_a_visual_proof_that_neural_nets_can_compute_any_function" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html">A visual proof that neural nets can compute any function</a></p><div id="toc_a_visual_proof_that_neural_nets_can_compute_any_function" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap4.html#two_caveats"><li>Two caveats</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#universality_with_one_input_and_one_output"><li>Universality with one input and one output</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#many_input_variables"><li>Many input variables</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#extension_beyond_sigmoid_neurons"><li>Extension beyond sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#fixing_up_the_step_functions"><li>Fixing up the step functions</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#conclusion"><li>Conclusion</li></a></ul><p></p></div>
<script>
$('#toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal').click(function() { 
   var src = $('#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow.png');
   };
   $('#toc_a_visual_proof_that_neural_nets_can_compute_any_function').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_why_are_deep_neural_networks_hard_to_train_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_why_are_deep_neural_networks_hard_to_train" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html">Why are deep neural networks hard to train?</a></p><div id="toc_why_are_deep_neural_networks_hard_to_train" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap5.html#the_vanishing_gradient_problem"><li>The vanishing gradient problem</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#what&#39;s_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets"><li>What's causing the vanishing gradient problem?  Unstable gradients in deep neural nets</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#unstable_gradients_in_more_complex_networks"><li>Unstable gradients in more complex networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#other_obstacles_to_deep_learning"><li>Other obstacles to deep learning</li></a></ul><p></p></div>
<script>
$('#toc_why_are_deep_neural_networks_hard_to_train_reveal').click(function() { 
   var src = $('#toc_img_why_are_deep_neural_networks_hard_to_train').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow.png');
   };
   $('#toc_why_are_deep_neural_networks_hard_to_train').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_deep_learning_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_deep_learning" src="./chap05_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html">Deep learning</a></p><div id="toc_deep_learning" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap6.html#introducing_convolutional_networks"><li>Introducing convolutional networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html#convolutional_neural_networks_in_practice"><li>Convolutional neural networks in practice</li></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html#the_code_for_our_convolutional_networks"><li>The code for our convolutional networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html#recent_progress_in_image_recognition"><li>Recent progress in image recognition</li></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html#other_approaches_to_deep_neural_nets"><li>Other approaches to deep neural nets</li></a><a href="http://neuralnetworksanddeeplearning.com/chap6.html#on_the_future_of_neural_networks"><li>On the future of neural networks</li></a></ul><p></p></div>
<script>
$('#toc_deep_learning_reveal').click(function() { 
   var src = $('#toc_img_deep_learning').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_deep_learning").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_deep_learning").attr('src', 'images/arrow.png');
   };
   $('#toc_deep_learning').toggle('fast', function() {});  
});</script><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/sai.html">Appendix: Is there a <em>simple</em> algorithm for intelligence?</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/acknowledgements.html">Acknowledgements</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/faq.html">Frequently Asked Questions</a></p>
<hr>

<p class="sidebar"> If you benefit from the book, please make a small
donation.  I suggest $3, but you can choose the amount.</p>

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHTwYJKoZIhvcNAQcEoIIHQDCCBzwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYAtusFIFTgWVpgZsMgI9zMrWRAFFKQqeFiE6ay1nbmP360YzPtR+vvCXwn214Az9+F9g7mFxe0L+m9zOCdjzgRROZdTu1oIuS78i0TTbcbD/Vs/U/f9xcmwsdX9KYlhimfsya0ydPQ2xvr4iSGbwfNemIPVRCTadp/Y4OQWWRFKGTELMAkGBSsOAwIaBQAwgcwGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIK5obVTaqzmyAgajgc4w5t7l6DjTGVI7k+4UyO3uafxPac23jOyBGmxSnVRPONB9I+/Q6OqpXZtn8JpTuzFmuIgkNUf1nldv/DA1mhPOeeVxeuSGL8KpWxpJboKZ0mEu9b+0FJXvZW+snv0jodnRDtI4g0AXDZNPyRWIdJ3m+tlYfsXu4mQAe0q+CyT+QrSRhPGI/llicF4x3rMbRBNqlDze/tFqp/jbgW84Puzz6KyxAez6gggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xNTA4MDUxMzMyMTRaMCMGCSqGSIb3DQEJBDEWBBRtGLYvbZ45sWVegWVP2CuXTHPmJTANBgkqhkiG9w0BAQEFAASBgKgrMHMINfV7yVuZgcTjp8gUzejPF2x2zRPU/G8pKUvYIl1F38TjV2pe4w0QXcGMJRT8mQfxHCy9UmF3LfblH8F0NSMMDrZqu3M0eLk96old+L0Xl6ING8l3idFDkLagE+lZK4A0rNV35aMci3VLvjQ34CvEj7jaHeLpbkgk/l6v-----END PKCS7-----
">
<input type="image" src="./chap05_files/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="./chap05_files/pixel.gif" width="1" height="1">
</form>

<hr>
<span class="sidebar_title">Sponsors</span>
<br>
<a href="http://www.ersatz1.com/"><img src="./chap05_files/ersatz.png" width="140px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://gsquaredcapital.com/"><img src="./chap05_files/gsquared.png" width="150px" style="padding: 0px 0px 10px 10px; border-style: none;"></a>

<a href="http://www.tineye.com/"><img src="./chap05_files/tineye.png" width="150px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://www.visionsmarts.com/"><img src="./chap05_files/visionsmarts.png" width="160px" style="padding: 0px 0px
0px 0px; border-style: none;"></a> <br> 

<p class="sidebar">Thanks to all the <a href="http://neuralnetworksanddeeplearning.com/supporters.html">supporters</a> who made the book possible, with
especial thanks to Pavel Dudrenov.  Thanks also to all the
contributors to the <a href="http://neuralnetworksanddeeplearning.com/bugfinder.html">Bugfinder Hall of
Fame</a>.  </p>

<hr>
<span class="sidebar_title">Resources</span>

<p class="sidebar"><a href="http://neuralnetworksanddeeplearning.com/faq.html">Book FAQ</a></p>

<p class="sidebar">
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning">Code repository</a></p>

<p class="sidebar">
<a href="http://eepurl.com/0Xxjb">Michael Nielsen's project announcement mailing list</a>
</p>

<p class="sidebar"> <a href="http://www.iro.umontreal.ca/~bengioy/dlbook/">Deep Learning</a>, draft book
in preparation, by Yoshua Bengio, Ian Goodfellow, and Aaron
Courville</p>

<hr>
<a href="http://michaelnielsen.org/"><img src="./chap05_files/Michael_Nielsen_Web_Small.jpg" width="160px" style="border-style: none;"></a>

<p class="sidebar">
By <a href="http://michaelnielsen.org/">Michael Nielsen</a> / Jan 2016
</p>
</div>
<p></p><p>Imagine you're an engineer who has been asked to design a computer
from scratch.  One day you're working away in your office, designing
logical circuits, setting out <code>AND</code> gates, <code>OR</code> gates,
and so on, when your boss walks in with bad news. The customer has
just added a surprising design requirement: the circuit for the entire
computer must be just two layers deep:</p><p></p><center><img src="./chap05_files/shallow_circuit.png" width="500px"></center><p></p><p>You're dumbfounded, and tell your boss: "The customer is crazy!"</p><p>Your boss replies: "I think they're crazy, too.  But what the
customer wants, they get."</p><p>In fact, there's a limited sense in which the customer isn't crazy.
Suppose you're allowed to use a special logical gate which lets you
<code>AND</code> together as many inputs as you want.  And you're also
allowed a many-input <code>NAND</code> gate, that is, a gate which can
<code>AND</code> multiple inputs and then negate the output.  With these
special gates it turns out to be possible to compute any function at
all using a circuit that's just two layers deep.</p><p>But just because something is possible doesn't make it a good idea.
In practice, when solving circuit design problems (or most any kind of
algorithmic problem), we usually start by figuring out how to solve
sub-problems, and then gradually integrate the solutions.  In other
words, we build up to a solution through multiple layers of
abstraction.  </p><p>For instance, suppose we're designing a logical circuit to multiply
two numbers.  Chances are we want to build it up out of sub-circuits
doing operations like adding two numbers.  The sub-circuits for adding
two numbers will, in turn, be built up out of sub-sub-circuits for
adding two bits.  Very roughly speaking our circuit will look like:</p><p></p><center><img src="./chap05_files/circuit_multiplication.png" width="500px"></center><p></p><p>That is, our final circuit contains at least three layers of circuit
elements.  In fact, it'll probably contain more than three layers, as
we break the sub-tasks down into smaller units than I've described.
But you get the general idea.</p><p>So deep circuits make the process of design easier.  But they're not
just helpful for design.  There are, in fact, mathematical proofs
showing that for some functions very shallow circuits require
exponentially more circuit elements to compute than do deep circuits.
For instance, a famous series of papers in the early
1980s*<span class="marginnote">
*The history is somewhat complex, so I won't give
  detailed references.  See Johan Håstad's 2012 paper
  <a href="http://eccc.hpi-web.de/report/2012/137/">On the correlation of
    parity and small-depth circuits</a> for an account of the early
  history and references.</span> showed that computing the parity of a set
of bits requires exponentially many gates, if done with a shallow
circuit.  On the other hand, if you use deeper circuits it's easy to
compute the parity using a small circuit: you just compute the parity
of pairs of bits, then use those results to compute the parity of
pairs of pairs of bits, and so on, building up quickly to the overall
parity.  Deep circuits thus can be intrinsically much more powerful
than shallow circuits.</p><p>Up to now, this book has approached neural networks like the crazy
customer.  Almost all the networks we've worked with have just a
single hidden layer of neurons (plus the input and output layers):</p><p></p><center>
<img src="./chap05_files/tikz35.png">
</center><p></p><p>These simple networks have been remarkably useful: in earlier chapters
we used networks like this to classify handwritten digits with better
than 98 percent accuracy!  Nonetheless, intuitively we'd expect
networks with many more hidden layers to be more powerful:</p><p></p><center>
<img src="./chap05_files/tikz36.png">
</center><p></p><p>Such networks could use the intermediate layers to build up multiple
layers of abstraction, just as we do in Boolean circuits.  For
instance, if we're doing visual pattern recognition, then the neurons
in the first layer might learn to recognize edges, the neurons in the
second layer could learn to recognize more complex shapes, say
triangle or rectangles, built up from edges.  The third layer would
then recognize still more complex shapes.  And so on.  These multiple
layers of abstraction seem likely to give deep networks a compelling
advantage in learning to solve complex pattern recognition problems.
Moreover, just as in the case of circuits, there are theoretical
results suggesting that deep networks are intrinsically more powerful
than shallow networks*<span class="marginnote">
*For certain problems and network
  architectures this is proved in
  <a href="http://arxiv.org/pdf/1312.6098.pdf">On the number of response
    regions of deep feed forward networks with piece-wise linear
    activations</a>, by Razvan Pascanu, Guido Montúfar, and Yoshua Bengio
  (2014). See also the more informal discussion in section 2 of
  <a href="http://www.iro.umontreal.ca/~bengioy/papers/ftml_book.pdf">Learning
    deep architectures for AI</a>, by Yoshua Bengio (2009).</span>.</p><p>How can we train such deep networks?  In this chapter, we'll try
training deep networks using our workhorse learning algorithm -
<a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent">stochastic
  gradient descent</a> by <a href="http://neuralnetworksanddeeplearning.com/chap2.html">backpropagation</a>.  But we'll
run into trouble, with our deep networks not performing much (if at
all) better than shallow networks.</p><p>That failure seems surprising in the light of the discussion above.
Rather than give up on deep networks, we'll dig down and try to
understand what's making our deep networks hard to train.  When we
look closely, we'll discover that the different layers in our deep
network are learning at vastly different speeds.  In particular, when
later layers in the network are learning well, early layers often get
stuck during training, learning almost nothing at all.  This stuckness
isn't simply due to bad luck.  Rather, we'll discover there are
fundamental reasons the learning slowdown occurs, connected to our use
of gradient-based learning techniques.</p><p>As we delve into the problem more deeply, we'll learn that the
opposite phenomenon can also occur: the early layers may be learning
well, but later layers can become stuck.  In fact, we'll find that
there's an intrinsic instability associated to learning by gradient
descent in deep, many-layer neural networks.  This instability tends
to result in either the early or the later layers getting stuck during
training.</p><p>This all sounds like bad news.  But by delving into these
difficulties, we can begin to gain insight into what's required to
train deep networks effectively.  And so these investigations are good
preparation for the next chapter, where we'll use deep learning to
attack image recognition problems.</p><p></p><h3><a name="the_vanishing_gradient_problem"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#the_vanishing_gradient_problem">The vanishing gradient problem</a></h3><p></p><p>So, what goes wrong when we try to train a deep network?</p><p>To answer that question, let's first revisit the case of a network
with just a single hidden layer.  As per usual, we'll use the MNIST
digit classification problem as our playground for learning and
experimentation*<span class="marginnote">
*I introduced the MNIST problem and data
  <a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent">here</a> and
  <a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits">here</a>.</span>.</p><p>If you wish, you can follow along by training networks on your
computer.  It is also, of course, fine to just read along.  If you do
wish to follow live, then you'll need Python 2.7, Numpy, and a copy of
the code, which you can get by cloning the relevant repository from
the command line:
</p><div class="highlight"><pre>git clone https://github.com/mnielsen/neural-networks-and-deep-learning.git
</pre></div>

If you don't use <tt>git</tt> then you can download the data and code
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/archive/master.zip">here</a>.  You'll need to change into the <tt>src</tt> subdirectory.<p></p><p>Then, from a Python shell we load the MNIST data:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
</pre></div>
<p></p><p>We set up our network:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
<p></p><p>This network has 784 neurons in the input layer, corresponding to the
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;28&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;28&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 6.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1006.08em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">28</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.248em;">×</span><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.248em;">28</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-12" style="font-family: MathJax_Main; padding-left: 0.297em;">784</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>28</mn><mo>×</mo><mn>28</mn><mo>=</mo><mn>784</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">28 \times 28 = 784</script> pixels in the input image.  We use 30 hidden
neurons, as well as 10 output neurons, corresponding to the 10
possible classifications for the MNIST digits ('0', '1', '2', <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.914em 1001.08em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">…</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.202em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">\ldots</script>,
'9').</p><p>Let's try training our network for 30 complete epochs, using
mini-batches of 10 training examples at a time, a learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1003.09em 2.502em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.297em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>=</mo><mn>0.1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">\eta
= 0.1</script>, and regularization parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5.0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1003.19em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mn>5.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">\lambda = 5.0</script>.  As we train
we'll monitor the classification accuracy on the
<tt>validation_data</tt>*<span class="marginnote">
*Note that the networks is likely to
  take some minutes to train, depending on the speed of your machine.
  So if you're running the code you may wish to continue reading and
  return later, not wait for the code to finish executing.</span>:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>We get a classification accuracy of 96.48 percent (or thereabouts -
it'll vary a bit from run to run), comparable to our earlier results
with a similar configuration.</p><p>Now, let's add another hidden layer, also with 30 neurons in it, and
try training with the same hyper-parameters:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>This gives an improved classification accuracy, 96.90 percent.  That's
encouraging: a little more depth is helping.  Let's add another
30-neuron hidden layer:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>That doesn't help at all.  In fact, the result drops back down to
96.57 percent, close to our original shallow network.  And suppose we
insert one further hidden layer:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>The classification accuracy drops again, to 96.53 percent.  That's
probably not a statistically significant drop, but it's not
encouraging, either.</p><p>This behaviour seems strange.  Intuitively, extra hidden layers ought
to make the network able to learn more complex classification
functions, and thus do a better job classifying.  Certainly, things
shouldn't get worse, since the extra layers can, in the worst case,
simply do nothing*<span class="marginnote">
*See <a href="http://neuralnetworksanddeeplearning.com/chap5.html#identity_neuron">this later
    problem</a> to understand how to build a hidden layer that does
  nothing.</span>.  But that's not what's going on.</p><p>So what is going on?  Let's assume that the extra hidden layers really
could help in principle, and the problem is that our learning
algorithm isn't finding the right weights and biases.  We'd like to
figure out what's going wrong in our learning algorithm, and how to do
better.</p><p>To get some insight into what's going wrong, let's visualize how the
network learns.  Below, I've plotted part of a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 6.473em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1006.23em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-29" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.15em;">10</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>784</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">[784, 30, 30, 10]</script>
network, i.e., a network with two hidden layers, each containing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 1.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.98em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mn" id="MathJax-Span-39" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>30</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">30</script>
hidden neurons.  Each neuron in the diagram has a little bar on it,
representing how quickly that neuron is changing as the network
learns.  A big bar means the neuron's weights and bias are changing
rapidly, while a small bar means the weights and bias are changing
slowly.  More precisely, the bars denote the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.89em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-44"><span class="mrow" id="MathJax-Span-45"><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\partial C
/ \partial b</script> for each neuron, i.e., the rate of change of the cost
with respect to the neuron's bias.  Back in
<a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">Chapter
  2</a> we saw that this gradient quantity controlled not just how
rapidly the bias changes during learning, but also how rapidly the
weights input to the neuron change, too.  Don't worry if you don't
recall the details: the thing to keep in mind is simply that these
bars show how quickly each neuron's weights and bias are changing as
the network learns.</p><p>To keep the diagram simple, I've shown just the top six neurons in the
two hidden layers.  I've omitted the input neurons, since they've got
no weights or biases to learn.  I've also omitted the output neurons,
since we're doing layer-wise comparisons, and it makes most sense to
compare layers with the same number of neurons.  The results are
plotted at the very beginning of training, i.e., immediately after the
network is initialized.  Here they are*<span class="marginnote">
*The data plotted is
  generated using the program
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/generate_gradient.py">generate_gradient.py</a>.
  The same program is also used to generate the results quoted later
  in this section.</span>:</p><p><canvas id="initial_gradient" width="470" height="620"></canvas></p><p>The network was initialized randomly, and so it's not surprising that
there's a lot of variation in how rapidly the neurons learn.  Still,
one thing that jumps out is that the bars in the second hidden layer
are mostly much larger than the bars in the first hidden layer.  As a
result, the neurons in the second hidden layer will learn quite a bit
faster than the neurons in the first hidden layer.  Is this merely a
coincidence, or are the neurons in the second hidden layer likely to
learn faster than neurons in the first hidden layer in general?</p><p>To determine whether this is the case, it helps to have a global way
of comparing the speed of learning in the first and second hidden
layers.  To do this, let's denote the gradient as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" style="width: 5.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1005.44em 2.748em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.3em 4.169em -999.998em); top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.35em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.297em;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.3em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.35em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>j</mi><mi>l</mi></msubsup><mo>=</mo><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msubsup><mi>b</mi><mi>j</mi><mi>l</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-9">\delta^l_j
= \partial C /
\partial b^l_j</script>, i.e., the gradient for the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.453em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">j</script>th neuron in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 0.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.25em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">l</script>th
layer*<span class="marginnote">
*Back in
  <a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">Chapter
    2</a> we referred to this as the error, but here we'll adopt the
  informal term "gradient".  I say "informal" because of course
  this doesn't explicitly include the partial derivatives of the cost
  with respect to the weights, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-72" style="width: 3.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.109em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.23em 1003.11em 2.7em -999.996em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.086em;"></span></span><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.21em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 1.171em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">\partial C / \partial w</script>.</span>.  We can
think of the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.13em 1000.93em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="msubsup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mn>1</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-13">\delta^1</script> as a vector whose entries determine
how quickly the first hidden layer learns, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.13em 1000.93em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-14">\delta^2</script> as a vector
whose entries determine how quickly the second hidden layer learns.
We'll then use the lengths of these vectors as (rough!)  global
measures of the speed at which the layers are learning.  So, for
instance, the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 2.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1001.82em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">∥</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msup><mi>δ</mi><mn>1</mn></msup><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">\| \delta^1 \|</script> measures the speed at which the
first hidden layer is learning, while the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 2.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1001.82em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">∥</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msup><mi>δ</mi><mn>2</mn></msup><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">\| \delta^2 \|</script>
measures the speed at which the second hidden layer is learning.</p><p>With these definitions, and in the same configuration as was plotted
above, we find <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.07&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 6.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.424em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1006.33em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">∥</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.297em;">0.07</span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msup><mi>δ</mi><mn>1</mn></msup><mo fence="false" stretchy="false">‖</mo><mo>=</mo><mn>0.07</mn><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">\| \delta^1 \| = 0.07\ldots</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.31&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" style="width: 6.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.424em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1006.33em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-116"><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">∥</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.297em;">0.31</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msup><mi>δ</mi><mn>2</mn></msup><mo fence="false" stretchy="false">‖</mo><mo>=</mo><mn>0.31</mn><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">\| \delta^2 \| =
0.31\ldots</script>.  So this confirms our earlier suspicion: the neurons in
the second hidden layer really are learning much faster than the
neurons in the first hidden layer.</p><p>What happens if we add more hidden layers?  If we have three hidden
layers, in a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-125" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.65em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-126"><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-128" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.15em;">10</span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>784</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">[784, 30, 30, 30, 10]</script> network, then the respective
speeds of learning turn out to be 0.012, 0.060, and 0.283.  Again,
earlier hidden layers are learning much slower than later hidden
layers.  Suppose we add yet another layer with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-138" style="width: 1.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.98em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="mn" id="MathJax-Span-140" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>30</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">30</script> hidden neurons.
In that case, the respective speeds of learning are 0.003, 0.017,
0.070, and 0.285.  The pattern holds: early layers learn slower than
later layers.</p><p>We've been looking at the speed of learning at the start of training,
that is, just after the networks are initialized.  How does the speed
of learning change as we train our networks?  Let's return to look at
the network with just two hidden layers.  The speed of learning
changes as follows:</p><p></p><center><img src="./chap05_files/training_speed_2_layers.png" width="500px"></center><p></p><p>To generate these results, I used batch gradient descent with just
1,000 training images, trained over 500 epochs.  This is a bit
different than the way we usually train - I've used no mini-batches,
and just 1,000 training images, rather than the full 50,000 image
training set.  I'm not trying to do anything sneaky, or pull the wool
over your eyes, but it turns out that using mini-batch stochastic
gradient descent gives much noisier (albeit very similar, when you
average away the noise) results.  Using the parameters I've chosen is
an easy way of smoothing the results out, so we can see what's going
on.</p><p>In any case, as you can see the two layers start out learning at very
different speeds (as we already know).  The speed in both layers then
drops very quickly, before rebounding.  But through it all, the first
hidden layer learns much more slowly than the second hidden layer.</p><p>What about more complex networks?  Here's the results of a similar
experiment, but this time with three hidden layers (a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.65em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-144" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-150" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.15em;">10</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>784</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">[784, 30, 30,
30, 10]</script> network):</p><p></p><center><img src="./chap05_files/training_speed_3_layers.png" width="500px"></center><p></p><p>Again, early hidden layers learn much more slowly than later hidden
layers.  Finally, let's add a fourth hidden layer (a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 9.365em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1009.07em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-157" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.15em;">10</span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>784</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">[784, 30, 30,
30, 30, 10]</script> network), and see what happens when we train:</p><p></p><center><img src="./chap05_files/training_speed_4_layers.png" width="500px"></center><p></p><p>Again, early hidden layers learn much more slowly than later hidden
layers.  In this case, the first hidden layer is learning roughly 100
times slower than the final hidden layer.  No wonder we were having
trouble training these networks earlier!</p><p>We have here an important observation: in at least some deep neural
networks, the gradient tends to get smaller as we move backward
through the hidden layers.  This means that neurons in the earlier
layers learn much more slowly than neurons in later layers.  And while
we've seen this in just a single network, there are fundamental
reasons why this happens in many neural networks.  The phenomenon is
known as the <em>vanishing gradient problem</em>*<span class="marginnote">
*See
  <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.24.7321">Gradient
    flow in recurrent nets: the difficulty of learning long-term
    dependencies</a>, by Sepp Hochreiter, Yoshua Bengio, Paolo Frasconi,
  and Jürgen Schmidhuber (2001).  This paper studied recurrent
  neural nets, but the essential phenomenon is the same as in the
  feedforward networks we are studying.  See also Sepp Hochreiter's
  earlier Diploma Thesis,
  <a href="http://www.idsia.ch/~juergen/SeppHochreiter1991ThesisAdvisorSchmidhuber.pdf">Untersuchungen
    zu dynamischen neuronalen Netzen</a> (1991, in German).</span>.</p><p>Why does the vanishing gradient problem occur?  Are there ways we can
avoid it?  And how should we deal with it in training deep neural
networks?  In fact, we'll learn shortly that it's not inevitable,
although the alternative is not very attractive, either: sometimes the
gradient gets much larger in earlier layers!  This is the
<em>exploding gradient problem</em>, and it's not much better news than
the vanishing gradient problem.  More generally, it turns out that the
gradient in deep neural networks is <em>unstable</em>, tending to either
explode or vanish in earlier layers.  This instability is a
fundamental problem for gradient-based learning in deep neural
networks.  It's something we need to understand, and, if possible,
take steps to address.</p><p>One response to vanishing (or unstable) gradients is to wonder if
they're really such a problem.  Momentarily stepping away from neural
nets, imagine we were trying to numerically minimize a function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-169" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">f(x)</script>
of a single variable.  Wouldn't it be good news if the derivative
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.16em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="msup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.54em 4.365em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">f'(x)</script> was small?  Wouldn't that mean we were already near an
extremum?  In a similar way, might the small gradient in early layers
of a deep network mean that we don't need to do much adjustment of the
weights and biases?</p><p>Of course, this isn't the case.  Recall that we randomly initialized
the weight and biases in the network.  It is extremely unlikely our
initial weights and biases will do a good job at whatever it is we
want our network to do.  To be concrete, consider the first layer of
weights in a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-183" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.65em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-184"><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-186" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.15em;">30</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.15em;">10</span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>784</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>30</mn><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">[784, 30, 30, 30, 10]</script> network for the MNIST problem.
The random initialization means the first layer throws away most
information about the input image.  Even if later layers have been
extensively trained, they will still find it extremely difficult to
identify the input image, simply because they don't have enough
information.  And so it can't possibly be the case that not much
learning needs to be done in the first layer.  If we're going to train
deep networks, we need to figure out how to address the vanishing
gradient problem.</p><p></p><h3><a name="what&#39;s_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#what&#39;s_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets">What's causing the vanishing gradient problem?  Unstable gradients in deep neural nets</a></h3><p></p><p>To get insight into why the vanishing gradient problem occurs, let's
consider the simplest deep neural network: one with just a single
neuron in each layer.  Here's a network with three hidden layers:
</p><center>
  <img src="./chap05_files/tikz37.png">
</center><p></p><p>Here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-196" style="width: 4.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.316em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.571em 1004.22em 2.502em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-202" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">w_1, w_2, \ldots</script> are the weights, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1003.63em 2.502em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-213" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>1</mn></msub><mo>,</mo><msub><mi>b</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">b_1, b_2, \ldots</script> are the
biases, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-218" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.79em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">C</script> is some cost function.  Just to remind you how this
works, the output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.88em 2.551em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-222"><span class="msubsup" id="MathJax-Span-223"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">a_j</script> from the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.453em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">j</script>th neuron is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-229" style="width: 2.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.208em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.11em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">\sigma(z_j)</script>, where
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.59em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">\sigma</script> is the usual <a href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons">sigmoid
  activation function</a>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-240" style="width: 7.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1007.16em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-241"><span class="msubsup" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-246" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="texatom" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-259" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">z_j = w_{j} a_{j-1}+b_j</script> is the weighted
input to the neuron.  I've drawn the cost <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-262" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.79em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">C</script> at the end to emphasize
that the cost is a function of the network's output, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-265" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.98em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-266"><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-269" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>4</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">a_4</script>: if the
actual output from the network is close to the desired output, then
the cost will be low, while if it's far away, the cost will be high.</p><p>We're going to study the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-270" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-271"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">\partial C / \partial b_1</script>
associated to the first hidden neuron.  We'll figure out an expression
for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-281" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-285"><span class="mrow" id="MathJax-Span-286"><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-289"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">\partial C / \partial b_1</script>, and by studying that expression we'll
understand why the vanishing gradient problem occurs.</p><p>I'll start by simply showing you the expression for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-292" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">\partial C /
\partial b_1</script>.  It looks forbidding, but it's actually got a simple
structure, which I'll describe in a moment.  Here's the expression
(ignore the network, for now, and note that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-303" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.228em 1000.88em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-304"><span class="msup" id="MathJax-Span-305"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-307" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">\sigma'</script> is just the
derivative of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-308" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.59em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">\sigma</script> function):</p><p></p><center>
  <img src="./chap05_files/tikz38.png">
</center><p></p><p>The structure in the expression is as follows: there is a
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-311" style="width: 2.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.4em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-312"><span class="msup" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41">\sigma'(z_j)</script> term in the product for each neuron in the network; a
weight <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-321" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1001.08em 2.551em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="msubsup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">w_j</script> term for each weight in the network; and a final
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-326" style="width: 3.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.43em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-330"><span class="mrow" id="MathJax-Span-331"><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-334"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mn>4</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">\partial C / \partial a_4</script> term, corresponding to the cost function
at the end.  Notice that I've placed each term in the expression above
the corresponding part of the network.  So the network itself is a
mnemonic for the expression.</p><p>You're welcome to take this expression for granted, and skip to the
<a href="http://neuralnetworksanddeeplearning.com/chap5.html#discussion_why">discussion of how it relates to the vanishing
  gradient problem</a>.  There's no harm in doing this, since the
expression is a special case of our
<a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">earlier
  discussion of backpropagation</a>.  But there's also a simple
explanation of why the expression is true, and so it's fun (and
perhaps enlightening) to take a look at that explanation.</p><p>Imagine we make a small change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 1.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.67em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-340"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-44">\Delta b_1</script> in the bias <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.84em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-45">b_1</script>.  That
will set off a cascading series of changes in the rest of the network.
First, it causes a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-348" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">\Delta a_1</script> in the output from the first
hidden neuron.  That, in turn, will cause a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-354" style="width: 1.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.72em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-357"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>z</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">\Delta z_2</script> in the
weighted input to the second hidden neuron.  Then a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\Delta
a_2</script> in the output from the second hidden neuron.  And so on, all the
way through to a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-366" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.62em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">\Delta C</script> in the cost at the output.  We have
<a class="displaced_anchor" name="eqtn114"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-114&quot;&gt;&lt;mtext&gt;(114)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-370" style="width: 100%; display: inline-block; min-width: 11.62em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 11.62em;"><span style="position: absolute; clip: rect(2.502em 1005.39em 5.051em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-371"><span class="mtable" id="MathJax-Span-372" style="min-width: 11.62em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.62em;"><span style="display: inline-block; position: absolute; width: 5.493em; height: 0px; clip: rect(-1.517em 1005.39em 1.032em -999.998em); top: 0em; left: 50%; margin-left: -2.743em;"><span style="position: absolute; clip: rect(2.502em 1005.39em 5.051em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.493em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1005.39em 5.002em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="MathJax-Span-376"><span class="mrow" id="MathJax-Span-377"><span class="mfrac" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.42em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-382"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-384"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.52em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.522em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span><span class="mfrac" id="MathJax-Span-388" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.57em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.67em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.82em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.816em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.444em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="mjx-eqn-114"><span class="mrow" id="MathJax-Span-374"><span class="mtext" id="MathJax-Span-375" style="font-family: MathJax_Main;">(114)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.948em; border-left: 0px solid; width: 0px; height: 2.353em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-114"><mtext>(114)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>≈</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\begin{eqnarray}
  \frac{\partial C}{\partial b_1} \approx \frac{\Delta C}{\Delta b_1}.
\tag{114}\end{eqnarray}</script>
This suggests that we can figure out an expression for the gradient
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">\partial C / \partial b_1</script> by carefully tracking the effect of each
step in this cascade.</p><p>To do this, let's think about how <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-409" style="width: 1.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.67em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">\Delta b_1</script> causes the output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.98em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-416"><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">a_1</script>
from the first hidden neuron to change.  We have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-420" style="width: 11.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1011.42em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-421"><span class="msubsup" id="MathJax-Span-422"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-442" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-54">a_1 = \sigma(z_1) =
\sigma(w_1 a_0 + b_1)</script>, so
<a class="displaced_anchor" name="eqtn115"></a><a class="displaced_anchor" name="eqtn116"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-115&quot;&gt;&lt;mtext&gt;(115)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-116&quot;&gt;&lt;mtext&gt;(116)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-446" style="width: 100%; display: inline-block; min-width: 17.502em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 17.502em;"><span style="position: absolute; clip: rect(2.453em 1011.33em 6.375em -999.998em); top: -4.654em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-447"><span class="mtable" id="MathJax-Span-448" style="min-width: 17.502em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.502em;"><span style="display: inline-block; position: absolute; width: 11.326em; height: 0px; clip: rect(-2.203em 1011.33em 1.718em -999.998em); top: 0em; left: 50%; margin-left: -5.684em;"><span style="position: absolute; clip: rect(2.551em 1001.82em 5.493em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1001.82em 4.316em -999.998em); top: -4.654em; right: 0em;"><span class="mtd" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-455"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000em 4.169em -999.998em); top: -2.694em; right: 0em;"><span class="mtd" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.797em 1001.03em 5.493em -999.998em); top: -4.017em; left: 1.816em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1001.03em 4.169em -999.998em); top: -4.654em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460"></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1001.03em 4.169em -999.998em); top: -2.694em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496"></span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.453em 1008.19em 6.375em -999.998em); top: -4.654em; left: 3.14em;"><span style="display: inline-block; position: relative; width: 8.189em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1008.19em 5.002em -999.998em); top: -4.654em; left: 0em;"><span class="mtd" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mfrac" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 6.277em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1006.08em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -3.086em;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-472"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-476" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-477" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.42em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-480"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-482"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1006.28em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.277em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1004.46em 4.414em -999.998em); top: -2.694em; left: 0em;"><span class="mtd" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="msup" id="MathJax-Span-500"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-509"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.659em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-1.517em 1002.21em 1.718em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -4.654em; right: 0em;"><span class="mtd" id="mjx-eqn-115"><span class="mrow" id="MathJax-Span-450"><span class="mtext" id="MathJax-Span-451" style="font-family: MathJax_Main;">(115)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -2.694em; right: 0em;"><span class="mtd" id="mjx-eqn-116"><span class="mrow" id="MathJax-Span-490"><span class="mtext" id="MathJax-Span-491" style="font-family: MathJax_Main;">(116)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.659em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.648em; border-left: 0px solid; width: 0px; height: 3.853em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-115"><mtext>(115)</mtext></mtd><mtd><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>≈</mo></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></mtd></mlabeledtr><mlabeledtr><mtd id="mjx-eqn-116"><mtext>(116)</mtext></mtd><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-55">\begin{eqnarray}
  \Delta a_1 & \approx & 
  \frac{\partial \sigma(w_1 a_0+b_1)}{\partial b_1} \Delta b_1 \tag{115}\\
  & = & \sigma'(z_1) \Delta b_1.
\tag{116}\end{eqnarray}</script>
That <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-513" style="width: 2.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.45em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-514"><span class="msup" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-519"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">\sigma'(z_1)</script> term should look familiar: it's the first term in
our claimed expression for the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-533" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">\partial C / \partial b_1</script>.
Intuitively, this term converts a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-534" style="width: 1.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.67em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-537"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-539" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\Delta b_1</script> in the bias into
a change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-540" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\Delta a_1</script> in the output activation.  That change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-546" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">\Delta
a_1</script> in turn causes a change in the weighted input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-552" style="width: 6.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1006.47em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-553"><span class="msubsup" id="MathJax-Span-554"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-558" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-565" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>2</mn></msub><mo>=</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">z_2 = w_2 a_1 +
b_2</script> to the second hidden neuron:
<a class="displaced_anchor" name="eqtn117"></a><a class="displaced_anchor" name="eqtn118"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-117&quot;&gt;&lt;mtext&gt;(117)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-118&quot;&gt;&lt;mtext&gt;(118)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-568" style="width: 100%; display: inline-block; min-width: 12.895em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.895em;"><span style="position: absolute; clip: rect(2.355em 1006.77em 6.228em -999.998em); top: -4.556em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-569"><span class="mtable" id="MathJax-Span-570" style="min-width: 12.895em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.895em;"><span style="display: inline-block; position: absolute; width: 6.767em; height: 0px; clip: rect(-2.203em 1006.77em 1.669em -999.998em); top: 0em; left: 50%; margin-left: -3.38em;"><span style="position: absolute; clip: rect(2.502em 1001.72em 5.444em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1001.72em 4.316em -999.998em); top: -4.654em; right: 0em;"><span class="mtd" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-577"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000em 4.169em -999.998em); top: -2.743em; right: 0em;"><span class="mtd" id="MathJax-Span-604"><span class="mrow" id="MathJax-Span-605"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.748em 1001.03em 5.444em -999.998em); top: -4.017em; left: 1.718em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1001.03em 4.169em -999.998em); top: -4.654em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="mi" id="MathJax-Span-582"></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1001.03em 4.169em -999.998em); top: -2.743em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-606"><span class="mrow" id="MathJax-Span-607"><span class="mi" id="MathJax-Span-608"></span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.257em 1003.68em 6.032em -999.998em); top: -4.458em; left: 3.091em;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1003.68em 5.002em -999.998em); top: -4.654em; left: 0em;"><span class="mtd" id="MathJax-Span-584"><span class="mrow" id="MathJax-Span-585"><span class="mfrac" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.47em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-587"><span class="mi" id="MathJax-Span-588" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.52em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-594"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.67em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1003.14em 4.316em -999.998em); top: -2.743em; left: 0em;"><span class="mtd" id="MathJax-Span-610"><span class="mrow" id="MathJax-Span-611"><span class="msubsup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-618" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.463em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-1.566em 1002.21em 1.669em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -4.654em; right: 0em;"><span class="mtd" id="mjx-eqn-117"><span class="mrow" id="MathJax-Span-572"><span class="mtext" id="MathJax-Span-573" style="font-family: MathJax_Main;">(117)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -2.743em; right: 0em;"><span class="mtd" id="mjx-eqn-118"><span class="mrow" id="MathJax-Span-602"><span class="mtext" id="MathJax-Span-603" style="font-family: MathJax_Main;">(118)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.597em; border-left: 0px solid; width: 0px; height: 3.752em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-117"><mtext>(117)</mtext></mtd><mtd><mi mathvariant="normal">Δ</mi><msub><mi>z</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>≈</mo></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mn>1</mn></msub></mrow></mfrac><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></mtd></mlabeledtr><mlabeledtr><mtd id="mjx-eqn-118"><mtext>(118)</mtext></mtd><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-62">\begin{eqnarray}
  \Delta z_2 & \approx &
  \frac{\partial z_2}{\partial a_1} \Delta a_1 \tag{117}\\
  & = & w_2 \Delta a_1.
\tag{118}\end{eqnarray}</script>
Combining our expressions for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" style="width: 1.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.72em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-623"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>z</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-63">\Delta z_2</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-626" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.82em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-627"><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-629"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">\Delta a_1</script>, we see
how the change in the bias <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.84em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-633"><span class="msubsup" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-636" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">b_1</script> propagates along the network to
affect <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-637" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.88em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-638"><span class="msubsup" id="MathJax-Span-639"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-66">z_2</script>:
<a class="displaced_anchor" name="eqtn119"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-119&quot;&gt;&lt;mtext&gt;(119)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-642" style="width: 100%; display: inline-block; min-width: 14.904em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.904em;"><span style="position: absolute; clip: rect(3.091em 1008.68em 4.463em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-643"><span class="mtable" id="MathJax-Span-644" style="min-width: 14.904em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.904em;"><span style="display: inline-block; position: absolute; width: 8.777em; height: 0px; clip: rect(-0.929em 1008.68em 0.444em -999.998em); top: 0em; left: 50%; margin-left: -4.36em;"><span style="position: absolute; clip: rect(3.189em 1001.72em 4.365em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1001.72em 4.316em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mi" id="MathJax-Span-650" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-653" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1001.03em 4.218em -999.998em); top: -4.017em; left: 1.718em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1001.03em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-654"><span class="mrow" id="MathJax-Span-655"><span class="mi" id="MathJax-Span-656"></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1005.59em 4.463em -999.998em); top: -4.017em; left: 3.091em;"><span style="display: inline-block; position: relative; width: 5.689em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1005.59em 4.414em -999.998em); top: -3.968em; left: 0em;"><span class="mtd" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="msup" id="MathJax-Span-660"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-663" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-664"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-666" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-672"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.444em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="mjx-eqn-119"><span class="mrow" id="MathJax-Span-646"><span class="mtext" id="MathJax-Span-647" style="font-family: MathJax_Main;">(119)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-119"><mtext>(119)</mtext></mtd><mtd><mi mathvariant="normal">Δ</mi><msub><mi>z</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>≈</mo></mtd><mtd><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">\begin{eqnarray}
\Delta z_2 & \approx & \sigma'(z_1) w_2 \Delta b_1.
\tag{119}\end{eqnarray}</script>
Again, that should look familiar: we've now got the first two terms in
our claimed expression for the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-676" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-680"><span class="mrow" id="MathJax-Span-681"><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-68">\partial C / \partial b_1</script>.</p><p>We can keep going in this fashion, tracking the way changes propagate
through the rest of the network.  At each neuron we pick up a
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-687" style="width: 2.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.4em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-688"><span class="msup" id="MathJax-Span-689"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-692" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-693"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-694" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-695" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">\sigma'(z_j)</script> term, and through each weight we pick up a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1001.08em 2.551em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-698"><span class="msubsup" id="MathJax-Span-699"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-701" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-70">w_j</script> term.
The end result is an expression relating the final change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-702" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.62em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">\Delta C</script>
in cost to the initial change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-706" style="width: 1.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.67em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-707"><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-709"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-72">\Delta b_1</script> in the bias:
<a class="displaced_anchor" name="eqtn120"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-120&quot;&gt;&lt;mtext&gt;(120)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-712" style="width: 100%; display: inline-block; min-width: 23.287em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 23.287em;"><span style="position: absolute; clip: rect(2.502em 1017.01em 5.051em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-713"><span class="mtable" id="MathJax-Span-714" style="min-width: 23.287em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.287em;"><span style="display: inline-block; position: absolute; width: 17.11em; height: 0px; clip: rect(-1.517em 1017.01em 1.032em -999.998em); top: 0em; left: 50%; margin-left: -8.527em;"><span style="position: absolute; clip: rect(3.189em 1001.57em 4.218em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1001.57em 4.169em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="MathJax-Span-718"><span class="mrow" id="MathJax-Span-719"><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1001.03em 4.218em -999.998em); top: -4.017em; left: 1.571em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1001.03em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-722"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724"></span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1014.07em 5.051em -999.998em); top: -4.017em; left: 2.944em;"><span style="display: inline-block; position: relative; width: 14.169em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1014.07em 5.002em -999.998em); top: -3.968em; left: 0em;"><span class="mtd" id="MathJax-Span-726"><span class="mrow" id="MathJax-Span-727"><span class="msup" id="MathJax-Span-728"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-730" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-734" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-736"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-739"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-740" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-741" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-745" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span><span class="msup" id="MathJax-Span-748" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-750" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-752"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-753" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-754" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-756"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-757"><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.52em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-760"><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-762"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.67em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-767" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-768" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-769" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.444em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="mjx-eqn-120"><span class="mrow" id="MathJax-Span-716"><span class="mtext" id="MathJax-Span-717" style="font-family: MathJax_Main;">(120)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.948em; border-left: 0px solid; width: 0px; height: 2.353em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-120"><mtext>(120)</mtext></mtd><mtd><mi mathvariant="normal">Δ</mi><mi>C</mi></mtd><mtd><mi></mi><mo>≈</mo></mtd><mtd><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>…</mo><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mn>4</mn></msub></mrow></mfrac><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\begin{eqnarray}
\Delta C & \approx & \sigma'(z_1) w_2 \sigma'(z_2) \ldots \sigma'(z_4) 
\frac{\partial C}{\partial a_4} \Delta b_1.
\tag{120}\end{eqnarray}</script>
Dividing by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-770" style="width: 1.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.67em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-771"><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-775" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-74">\Delta b_1</script> we do indeed get the desired expression for
the gradient:
<a class="displaced_anchor" name="eqtn121"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-121&quot;&gt;&lt;mtext&gt;(121)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-776" style="width: 100%; display: inline-block; min-width: 21.767em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 21.767em;"><span style="position: absolute; clip: rect(2.502em 1015.54em 5.051em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-777"><span class="mtable" id="MathJax-Span-778" style="min-width: 21.767em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.767em;"><span style="display: inline-block; position: absolute; width: 15.64em; height: 0px; clip: rect(-1.517em 1015.54em 1.032em -999.998em); top: 0em; left: 50%; margin-left: -7.792em;"><span style="position: absolute; clip: rect(2.502em 1015.54em 5.051em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 15.64em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1015.54em 5.002em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="MathJax-Span-782"><span class="mrow" id="MathJax-Span-783"><span class="mfrac" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.42em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-790"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.52em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.522em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msup" id="MathJax-Span-794" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-795" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-796" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-800" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-802"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-805"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-806" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-807" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-811" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span><span class="msup" id="MathJax-Span-814" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-815" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-817" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-818"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-822"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-823"><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.52em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-826"><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-828"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-830" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.67em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.444em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="mjx-eqn-121"><span class="mrow" id="MathJax-Span-780"><span class="mtext" id="MathJax-Span-781" style="font-family: MathJax_Main;">(121)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.948em; border-left: 0px solid; width: 0px; height: 2.353em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-121"><mtext>(121)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>…</mo><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mn>4</mn></msub></mrow></mfrac><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">\begin{eqnarray}
\frac{\partial C}{\partial b_1} = \sigma'(z_1) w_2 \sigma'(z_2) \ldots
\sigma'(z_4) \frac{\partial C}{\partial a_4}.
\tag{121}\end{eqnarray}</script></p><p><a id="discussion_why"></a></p><p><strong>Why the vanishing gradient problem occurs:</strong> To understand why
the vanishing gradient problem occurs, let's explicitly write out the
entire expression for the gradient:
<a class="displaced_anchor" name="eqtn122"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-122&quot;&gt;&lt;mtext&gt;(122)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-832" style="width: 100%; display: inline-block; min-width: 25.836em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 25.836em;"><span style="position: absolute; clip: rect(2.502em 1019.61em 5.051em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-833"><span class="mtable" id="MathJax-Span-834" style="min-width: 25.836em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.836em;"><span style="display: inline-block; position: absolute; width: 19.659em; height: 0px; clip: rect(-1.517em 1019.61em 1.032em -999.998em); top: 0em; left: 50%; margin-left: -9.85em;"><span style="position: absolute; clip: rect(2.502em 1019.61em 5.051em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.659em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1019.61em 5.002em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="mfrac" id="MathJax-Span-840"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-841"><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.42em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-844"><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-846"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-848" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.52em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.522em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-849" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msup" id="MathJax-Span-850" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-858" style="height: 0em; vertical-align: 0em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-859"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-862"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-863" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-865" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-870" style="height: 0em; vertical-align: 0em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-871"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-873" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-874"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-876" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-878"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-881" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-882" style="height: 0em; vertical-align: 0em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-889" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-890"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-891" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-894" style="height: 0em; vertical-align: 0em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mfrac" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1001.33em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-896"><span class="mi" id="MathJax-Span-897" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.52em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-899"><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-901"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-903" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.67em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-904" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.444em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.968em; right: 0em;"><span class="mtd" id="mjx-eqn-122"><span class="mrow" id="MathJax-Span-836"><span class="mtext" id="MathJax-Span-837" style="font-family: MathJax_Main;">(122)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.948em; border-left: 0px solid; width: 0px; height: 2.353em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-122"><mtext>(122)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><msub><mi>w</mi><mn>2</mn></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><msub><mi>w</mi><mn>3</mn></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><msub><mi>w</mi><mn>4</mn></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mn>4</mn></msub></mrow></mfrac><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-76">\begin{eqnarray}
\frac{\partial C}{\partial b_1} = \sigma'(z_1) \, w_2 \sigma'(z_2) \,
 w_3 \sigma'(z_3) \, w_4 \sigma'(z_4) \, \frac{\partial C}{\partial a_4}.
\tag{122}\end{eqnarray}</script>
Excepting the very last term, this expression is a product of terms of
the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-905" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-906"><span class="msubsup" id="MathJax-Span-907"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-908" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-910"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-912" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-917" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">w_j \sigma'(z_j)</script>.  To understand how each of those terms
behave, let's look at a plot of the function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-918" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.228em 1000.88em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-919"><span class="msup" id="MathJax-Span-920"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-78">\sigma'</script>: </p><div id="sigmoid_prime_graph"><a name="sigmoid_prime_graph"></a><svg width="600" height="290"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 200)"><g class="tick" transform="translate(36,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(72,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(144,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(180,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(251.99999999999997,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(288,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><path class="domain" d="M0,6V0H360V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.00</text></g><g class="tick" transform="translate(0,160)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.05</text></g><g class="tick" transform="translate(0,120)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.10</text></g><g class="tick" transform="translate(0,80)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.15</text></g><g class="tick" transform="translate(0,39.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.20</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.25</text></g><path class="domain" d="M-6,0H0V200H-6"></path></g><path d="M0,194.68155466336788L0.8999999999999808,194.5487649442399L1.8000000000000256,194.4127073546174L2.6999999999999744,194.2733038958767L3.5999999999999868,194.13047483132982L4.5,193.98413865389645L5.400000000000013,193.8342120535215L6.299999999999993,193.68060988435786L7.1999999999999735,193.5232451317364L8.099999999999987,193.36202887894584L9,193.1968702738484L9.900000000000013,193.0276764953572L10.800000000000026,192.8543527198061L11.699999999999976,192.67680208724093L12.599999999999985,192.494925667668L13.5,192.3086224272938L14.400000000000013,192.11778919479502L15.300000000000026,191.9223206276596L16.200000000000006,191.72210917864206L17.099999999999987,191.51704506237988L18,191.30701622221983L18.900000000000013,191.09190829730665L19.800000000000026,190.87160458999023L20.699999999999974,190.64598603360923L21.60000000000002,190.41493116071481L22.5,190.17831607179977L23.39999999999998,189.93601440460316L24.300000000000026,189.68789730406493L25.200000000000006,189.4338333930079L26.099999999999987,189.17368874362987L27,188.90732684989283L27.900000000000016,188.63460860090044L28.799999999999997,188.3553922553606L29.699999999999978,188.06953341723397L30.599999999999987,187.77688501267536L31.499999999999996,187.47729726837997L32.40000000000001,187.17061769145192L33.300000000000026,186.8566910509179L34.199999999999974,186.53535936101636L35.09999999999999,186.20646186639598L36,185.86983502936712L36.90000000000001,185.52531251935252L37.80000000000001,185.17272520469407L38.700000000000024,184.81190114697608L39.59999999999999,184.44266559803532L40.5,184.0648409998336L41.40000000000001,183.67824698737655L42.299999999999976,183.28270039487117L43.19999999999999,182.8780152653199L44.10000000000002,182.46400286376036L45,182.04047169436524L45.89999999999998,181.60722752162627L46.80000000000001,181.16407339585555L47.700000000000024,180.71080968324395L48.59999999999998,180.24723410072724L49.50000000000001,179.77314175591772L50.40000000000001,179.2883251923696L51.299999999999976,178.79257444045297L52.19999999999999,178.28567707412319L53.09999999999999,177.76741827387877L54,177.23758089621157L54.900000000000006,176.69594554986094L55.80000000000001,176.14229067919354L56.69999999999999,175.57639265503764L57.599999999999994,174.99802587331067L58.5,174.40696286178695L59.40000000000001,173.80297439535957L60.30000000000001,173.18582962016038L61.200000000000024,172.55529618690682L62.09999999999999,171.91114039385434L62.99999999999999,171.2531273397375L63.90000000000002,170.58102108709056L64.79999999999998,169.89458483634291L65.69999999999999,169.19358111109023L66.60000000000002,168.47777195494638L67.5,167.74691914038428L68.39999999999998,167.00078438997576L69.30000000000001,166.23912961044394L70.20000000000002,165.46171713993942L71.09999999999998,164.6683100089524L72,163.85867221527027L72.90000000000002,163.03256901338733L73.8,162.18976721876618L74.7,161.33003552734635L75.6,160.45314485068542L76.5,159.55886866710767L77.39999999999998,158.6469833892237L78.30000000000001,157.7172687481689L79.19999999999999,156.76950819489258L80.10000000000002,155.8034893188089L81,154.81900428410077L81.9,153.81585028394085L82.8,152.79383001286783L83.7,151.75275215752447L84.59999999999998,150.6924319059307L85.5,149.6126914754267L86.40000000000002,148.5133606593812L87.29999999999998,147.3942773927154L88.2,146.25528833624352L89.10000000000002,145.0962494797812L90,143.91702676391347L90.89999999999998,142.71749672025672L91.8,141.4975471299816L92.70000000000002,140.25707770029686L93.59999999999998,138.99600075851822L94.5,137.7142419632693L95.4,136.41174103227988L96.30000000000003,135.0884524861559L97.2,133.74434640740708L98.1,132.379409213918L99.00000000000001,130.99364444594963L99.9,129.58707356565026L100.80000000000003,128.159736767945L101.69999999999997,126.71169380155827L102.6,125.24302479880444L103.49999999999999,123.75383111265973L104.4,122.24423615949966L105.3,120.71438626575967L106.19999999999997,119.16445151663997L107.1,117.59462660484341L108,116.0051316771948L108.90000000000002,114.3962131768518L109.79999999999998,112.76814467867717L110.7,111.12122771520012L111.60000000000002,109.45579259045519L112.5,107.77219917884544L113.39999999999998,106.07083770603975L114.3,104.35212950877894L115.20000000000002,102.61652777033166L116.09999999999998,100.8645182282156L117,99.09661985067584L117.9,97.31338547829927L118.80000000000003,95.51540242703354L119.7,93.70329304878351L120.6,91.87771524566837L121.50000000000001,90.03936293394645L122.4,88.18896645355116L123.30000000000003,86.32729291913141L124.19999999999997,84.45514650845622L125.1,82.57336868402598L125.99999999999999,80.6828383437337L126.9,78.78447189644L127.8,76.8792232583667L128.7,74.96808376627864L129.6,73.0520820035083L130.5,71.13228353499056L131.4,69.20979054761037L132.29999999999998,67.28574139232981L133.2,65.3613100247518L134.10000000000002,63.43770534099522L135,61.516170406002416L135.89999999999998,59.59798157167722L136.8,57.684447482555434L137.70000000000002,55.7769079670422L138.6,53.87673281261478L139.5,51.98532042377848L140.4,50.10409636198352L141.3,48.23451176715237L142.20000000000002,46.37804166094113L143.1,44.53618313234982L144,42.71045340681452L144.9,40.90238780044997L145.80000000000004,39.113537561665915L146.69999999999996,37.345467602949654L147.6,35.599754126189296L148.5,33.877982145503594L149.4,32.18174291213995L150.29999999999998,30.512631246601842L151.2,28.872242783764477L152.1,27.262171137329293L153,25.68400499054877L153.9,24.139325120722365L154.79999999999995,22.629701365512812L155.7,21.156689539658235L156.59999999999997,19.721828311156898L157.5,18.326636046463697L158.40000000000003,16.972607634674162L159.3,15.661211301058398L160.20000000000005,14.393885420653408L161.1,13.172035342921507L162,11.997030238724404L162.9,10.870199981054984L163.8,9.792832071096536L164.70000000000002,8.766168621250191L165.6,7.791403406776687L166.5,6.869678997638062L167.4,6.002083981999928L168.30000000000004,5.189650292659187L169.19999999999996,4.4333506474033335L170.1,3.734096113974461L171,3.092733809921322L171.9,2.5100447471557485L172.79999999999998,1.98674183051204L173.7,1.5234680190204797L174.6,1.1207946579655959L175.5,0.7792199891059948L176.4,0.49916784568642125L177.29999999999995,0.2809865380846599L178.2,0.12494793510684499L179.09999999999997,0.031246745079838156L180,0L180.89999999999998,0.031246745079838156L181.8,0.12494793510684499L182.7,0.2809865380847043L183.6,0.49916784568642125L184.49999999999997,0.7792199891059948L185.4,1.1207946579655959L186.29999999999998,1.5234680190204797L187.20000000000002,1.98674183051204L188.1,2.510044747155704L189,3.092733809921322L189.89999999999998,3.734096113974439L190.8,4.4333506474033335L191.7,5.189650292659187L192.60000000000002,6.0020839819999505L193.5,6.869678997638062L194.4,7.791403406776665L195.29999999999998,8.766168621250191L196.20000000000002,9.792832071096559L197.1,10.870199981054984L198.00000000000003,11.997030238724404L198.9,13.172035342921507L199.8,14.393885420653474L200.7,15.661211301058398L201.60000000000002,16.972607634674162L202.5,18.326636046463697L203.39999999999998,19.721828311156877L204.3,21.156689539658235L205.2,22.629701365512744L206.1,24.139325120722365L206.99999999999997,25.68400499054877L207.9,27.262171137329293L208.79999999999998,28.872242783764456L209.70000000000002,30.512631246601842L210.6,32.18174291213995L211.5,33.877982145503594L212.39999999999998,35.59975412618921L213.3,37.345467602949654L214.2,39.113537561665915L215.10000000000002,40.90238780045006L216,42.71045340681452L216.9,44.53618313234984L217.79999999999998,46.37804166094113L218.70000000000002,48.23451176715243L219.6,50.10409636198352L220.50000000000003,51.985320423778525L221.4,53.87673281261478L222.3,55.77690796704229L223.2,57.684447482555434L224.10000000000002,59.59798157167726L225,61.516170406002416L225.89999999999998,63.4377053409952L226.8,65.3613100247518L227.7,67.2857413923297L228.6,69.20979054761037L229.49999999999997,71.13228353499056L230.4,73.0520820035083L231.29999999999998,74.96808376627855L232.20000000000002,76.8792232583667L233.1,78.78447189643998L234,80.6828383437337L234.89999999999998,82.57336868402592L235.8,84.45514650845622L236.7,86.32729291913141L237.60000000000002,88.18896645355126L238.5,90.03936293394645L239.4,91.87771524566838L240.29999999999998,93.70329304878351L241.20000000000002,95.51540242703358L242.1,97.31338547829927L243.00000000000003,99.09661985067586L243.9,100.8645182282156L244.8,102.61652777033174L245.7,104.35212950877894L246.60000000000002,106.0708377060398L247.5,107.77219917884544L248.39999999999998,109.45579259045518L249.3,111.12122771520012L250.2,112.76814467867709L251.1,114.3962131768518L251.99999999999997,116.0051316771948L252.9,117.59462660484341L253.79999999999998,119.16445151663994L254.70000000000002,120.71438626575967L255.6,122.24423615949966L256.5,123.75383111265973L257.4,125.24302479880438L258.3,126.71169380155827L259.2,128.159736767945L260.1,129.58707356565031L261,130.99364444594963L261.90000000000003,132.379409213918L262.8,133.74434640740708L263.7,135.08845248615592L264.6,136.41174103227988L265.5,137.7142419632693L266.4,138.99600075851822L267.3,140.25707770029695L268.2,141.4975471299816L269.1,142.71749672025672L270,143.91702676391347L270.9,145.0962494797812L271.8,146.25528833624352L272.7,147.39427739271534L273.6,148.5133606593812L274.5,149.6126914754267L275.4,150.6924319059307L276.3,151.75275215752447L277.2,152.79383001286783L278.09999999999997,153.81585028394085L279,154.81900428410077L279.9,155.8034893188089L280.8,156.76950819489258L281.7,157.71726874816886L282.6,158.6469833892237L283.5,159.55886866710767L284.40000000000003,160.45314485068542L285.3,161.33003552734635L286.2,162.18976721876618L287.1,163.03256901338733L288,163.85867221527027L288.9,164.6683100089524L289.8,165.46171713993948L290.69999999999993,166.23912961044394L291.6000000000001,167.00078438997576L292.5,167.74691914038428L293.3999999999999,168.47777195494638L294.30000000000007,169.19358111109023L295.2,169.8945848363429L296.1,170.58102108709056L297,171.2531273397375L297.9,171.91114039385434L298.79999999999995,172.55529618690682L299.7,173.18582962016038L300.59999999999997,173.80297439535957L301.5,174.40696286178695L302.40000000000003,174.99802587331067L303.3,175.57639265503767L304.2,176.14229067919354L305.09999999999997,176.69594554986094L306,177.23758089621157L306.90000000000003,177.76741827387877L307.8,178.28567707412319L308.70000000000005,178.79257444045297L309.6,179.2883251923696L310.5,179.77314175591772L311.4,180.24723410072724L312.3,180.71080968324398L313.19999999999993,181.16407339585555L314.1000000000001,181.6072275216263L315,182.04047169436524L315.8999999999999,182.46400286376036L316.80000000000007,182.8780152653199L317.7,183.28270039487114L318.6,183.67824698737655L319.5,184.0648409998336L320.4,184.44266559803532L321.29999999999995,184.81190114697608L322.2,185.17272520469407L323.09999999999997,185.52531251935252L324,185.86983502936712L324.90000000000003,186.20646186639598L325.8,186.53535936101636L326.7,186.8566910509179L327.59999999999997,187.17061769145192L328.5,187.47729726837997L329.40000000000003,187.77688501267536L330.3,188.06953341723397L331.20000000000005,188.35539225536064L332.1,188.63460860090044L333,188.90732684989283L333.9,189.17368874362987L334.8,189.4338333930079L335.69999999999993,189.68789730406493L336.6000000000001,189.93601440460316L337.5,190.17831607179977L338.3999999999999,190.41493116071481L339.30000000000007,190.64598603360923L340.2,190.87160458999023L341.1,191.09190829730665L342,191.30701622221983L342.9,191.51704506237988L343.79999999999995,191.72210917864206L344.7,191.9223206276596L345.59999999999997,192.11778919479502L346.5,192.3086224272938L347.40000000000003,192.494925667668L348.3,192.67680208724093L349.2,192.8543527198061L350.09999999999997,193.0276764953572L351,193.1968702738484L351.90000000000003,193.36202887894584L352.8,193.5232451317364L353.70000000000005,193.6806098843579L354.6,193.8342120535215L355.5,193.98413865389645L356.4,194.13047483132982L357.3,194.2733038958767L358.19999999999993,194.4127073546174L359.1000000000001,194.5487649442399"></path><text class="x label" text-anchor="end" x="180" y="235">z</text><text x="180" y="-10" text-anchor="middle" style="font-size: 16px;">Derivative of sigmoid function</text></g></svg></div><script type="text/javascript" src="./chap05_files/d3.v3.min.js.download"></script><p></p><p>The derivative reaches a maximum at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-923" style="width: 5.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.051em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1005em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-924"><span class="msup" id="MathJax-Span-925"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-927" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-928" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-929" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-932" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-936" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-79">\sigma'(0) = 1/4</script>.  Now, if we
use our <a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">standard approach</a>
to initializing the weights in the network, then we'll choose the
weights using a Gaussian with mean <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-937" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-938"><span class="mn" id="MathJax-Span-939" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-80">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-940" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-941"><span class="mn" id="MathJax-Span-942" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-81">1</script>.  So
the weights will usually satisfy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-943" style="width: 3.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.532em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-944"><span class="texatom" id="MathJax-Span-945"><span class="mrow" id="MathJax-Span-946"><span class="mo" id="MathJax-Span-947" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-948"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-949" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-950" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-951"><span class="mrow" id="MathJax-Span-952"><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-954" style="font-family: MathJax_Main; padding-left: 0.297em;">&lt;</span><span class="mn" id="MathJax-Span-955" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-82">|w_j| < 1</script>.  Putting these
observations together, we see that the terms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-956" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-957"><span class="msubsup" id="MathJax-Span-958"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-961"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-963" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-965"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">w_j \sigma'(z_j)</script> will
usually satisfy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-969" style="width: 7.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1006.96em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-970"><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="mo" id="MathJax-Span-973" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-974"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-977"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-980" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-981"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-984" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-985"><span class="mrow" id="MathJax-Span-986"><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Main; padding-left: 0.297em;">&lt;</span><span class="mn" id="MathJax-Span-989" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-990"><span class="mrow" id="MathJax-Span-991"><span class="mo" id="MathJax-Span-992" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-993" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&lt;</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-84">|w_j \sigma'(z_j)| < 1/4</script>.  And when we take a
product of many such terms, the product will tend to exponentially
decrease: the more terms, the smaller the product will be.  This is
starting to smell like a possible explanation for the vanishing
gradient problem.</p><p>To make this all a bit more explicit, let's compare the expression for
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-994" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-995"><span class="mi" id="MathJax-Span-996" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-997" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-998"><span class="mrow" id="MathJax-Span-999"><span class="mo" id="MathJax-Span-1000" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1001" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1002"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-85">\partial C / \partial b_1</script> to an expression for the gradient with
respect to a later bias, say <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1005" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1006"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1009"><span class="mrow" id="MathJax-Span-1010"><span class="mo" id="MathJax-Span-1011" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1012" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1013"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-86">\partial C / \partial b_3</script>.  Of course,
we haven't explicitly worked out an expression for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1016" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1017"><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1020"><span class="mrow" id="MathJax-Span-1021"><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1024"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1025" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-87">\partial C
/ \partial b_3</script>, but it follows the same pattern described above for
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1027" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1028"><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1030" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1031"><span class="mrow" id="MathJax-Span-1032"><span class="mo" id="MathJax-Span-1033" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1035"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">\partial C / \partial b_1</script>.  Here's the comparison of the two
expressions:
</p><center>
  <img src="./chap05_files/tikz39.png">
</center>
The two expressions share many terms.  But the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1038" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1041" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1042"><span class="mrow" id="MathJax-Span-1043"><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1046"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1047" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-89">\partial C
/ \partial b_1</script> includes two extra terms each of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1049" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1050"><span class="msubsup" id="MathJax-Span-1051"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1052" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1054"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1055" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1056" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1057" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1058"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1061" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-90">w_j
\sigma'(z_j)</script>. As we've seen, such terms are typically less than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1062" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1001.47em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1063"><span class="mn" id="MathJax-Span-1064" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-1065"><span class="mrow" id="MathJax-Span-1066"><span class="mo" id="MathJax-Span-1067" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1068" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-91">1/4</script>
in magnitude.  And so the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1069" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1070"><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1073"><span class="mrow" id="MathJax-Span-1074"><span class="mo" id="MathJax-Span-1075" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1076" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">\partial C / \partial b_1</script> will
usually be a factor of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1080" style="width: 1.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.98em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1081"><span class="mn" id="MathJax-Span-1082" style="font-family: MathJax_Main;">16</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>16</mn></math></span></span><script type="math/tex" id="MathJax-Element-93">16</script> (or more) smaller than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1083" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.29em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1084"><span class="mi" id="MathJax-Span-1085" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-1087"><span class="mrow" id="MathJax-Span-1088"><span class="mo" id="MathJax-Span-1089" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1091"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1092" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1093" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">\partial C
/ \partial b_3</script>.  This is the essential origin of the vanishing
gradient problem.<p></p><p>Of course, this is an informal argument, not a rigorous proof that the
vanishing gradient problem will occur.  There are several possible
escape clauses.  In particular, we might wonder whether the weights
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1094" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1001.08em 2.551em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1095"><span class="msubsup" id="MathJax-Span-1096"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-95">w_j</script> could grow during training.  If they do, it's possible the terms
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1099" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1100"><span class="msubsup" id="MathJax-Span-1101"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1102" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1104"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1105" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1108"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1109" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1111" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">w_j \sigma'(z_j)</script> in the product will no longer satisfy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1112" style="width: 7.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1006.96em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1113"><span class="texatom" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mo" id="MathJax-Span-1116" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1117"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1120"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1123" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1124"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1125" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1127" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="mo" id="MathJax-Span-1130" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1131" style="font-family: MathJax_Main; padding-left: 0.297em;">&lt;</span><span class="mn" id="MathJax-Span-1132" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-1133"><span class="mrow" id="MathJax-Span-1134"><span class="mo" id="MathJax-Span-1135" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1136" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&lt;</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-97">|w_j
\sigma'(z_j)| < 1/4</script>.  Indeed, if the terms get large enough -
greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1137" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1138"><span class="mn" id="MathJax-Span-1139" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-98">1</script> - then we will no longer have a vanishing gradient
problem.  Instead, the gradient will actually grow exponentially as we
move backward through the layers.  Instead of a vanishing gradient
problem, we'll have an exploding gradient problem.</p><p><strong>The exploding gradient problem:</strong> Let's look at an explicit
example where exploding gradients occur.  The example is somewhat
contrived: I'm going to fix parameters in the network in just the
right way to ensure we get an exploding gradient.  But even though the
example is contrived, it has the virtue of firmly establishing that
exploding gradients aren't merely a hypothetical possibility, they
really can happen.</p><p>There are two steps to getting an exploding gradient.  First, we
choose all the weights in the network to be large, say <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1140" style="width: 11.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1011.47em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1141"><span class="msubsup" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1143" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1144" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1145" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1146" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1149" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1150" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1151" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1152" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1153" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1154" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1155" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1156" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1157" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1158" style="font-family: MathJax_Main; padding-left: 0.297em;">100</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><msub><mi>w</mi><mn>3</mn></msub><mo>=</mo><msub><mi>w</mi><mn>4</mn></msub><mo>=</mo><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-99">w_1 = w_2 =
w_3 = w_4 = 100</script>.  Second, we'll choose the biases so that the
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1159" style="width: 2.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.4em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1160"><span class="msup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1164" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1165"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1166" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1168" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">\sigma'(z_j)</script> terms are not too small.  That's actually pretty easy
to do: all we need do is choose the biases to ensure that the weighted
input to each neuron is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1169" style="width: 2.748em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.699em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1002.65em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1170"><span class="msubsup" id="MathJax-Span-1171"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1172" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1174" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-101">z_j = 0</script> (and so <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1176" style="width: 5.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1005.35em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1177"><span class="msup" id="MathJax-Span-1178"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1180" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1182"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1183" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1185" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1186" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1187" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-1188"><span class="mrow" id="MathJax-Span-1189"><span class="mo" id="MathJax-Span-1190" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1191" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-102">\sigma'(z_j) = 1/4</script>).  So,
for instance, we want <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1192" style="width: 8.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.336em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1008.29em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1193"><span class="msubsup" id="MathJax-Span-1194"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1196" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1198" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1201"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1202" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-1205" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1206" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1209" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-103">z_1 = w_1 a_0 + b_1 = 0</script>.  We can achieve this
by setting <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1210" style="width: 6.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1006.47em 2.453em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1211"><span class="msubsup" id="MathJax-Span-1212"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1213" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mn" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1215" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main; padding-left: 0.297em;">−</span><span class="mn" id="MathJax-Span-1217" style="font-family: MathJax_Main;">100</span><span class="mo" id="MathJax-Span-1218" style="font-family: MathJax_Main; padding-left: 0.248em;">∗</span><span class="msubsup" id="MathJax-Span-1219" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1220" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-1221" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>100</mn><mo>∗</mo><msub><mi>a</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-104">b_1 = -100 * a_0</script>.  We can use the same idea to select the
other biases.  When we do this, we see that all the terms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1222" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.48em 2.6em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1223"><span class="msubsup" id="MathJax-Span-1224"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1227"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1228" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1230" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1231"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-1233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1234" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.348em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-105">w_j
\sigma'(z_j)</script> are equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1235" style="width: 5.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.13em 1005.49em 2.699em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1236"><span class="mn" id="MathJax-Span-1237" style="font-family: MathJax_Main;">100</span><span class="mo" id="MathJax-Span-1238" style="font-family: MathJax_Main; padding-left: 0.248em;">∗</span><span class="mfrac" id="MathJax-Span-1239" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.3em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-1240" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.35em 4.169em -999.998em); top: -3.625em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-1241" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.49em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.493em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1243" style="font-family: MathJax_Main; padding-left: 0.297em;">25</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.447em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>100</mn><mo>∗</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>=</mo><mn>25</mn></math></span></span><script type="math/tex" id="MathJax-Element-106">100 * \frac{1}{4} = 25</script>.  With these
choices we get an exploding gradient.</p><p><strong>The unstable gradient problem:</strong> The fundamental problem here
isn't so much the vanishing gradient problem or the exploding gradient
problem.  It's that the gradient in early layers is the product of
terms from all the later layers.  When there are many layers, that's
an intrinsically unstable situation.  The only way all layers can
learn at close to the same speed is if all those products of terms
come close to balancing out.  Without some mechanism or underlying
reason for that balancing to occur, it's highly unlikely to happen
simply by chance.  In short, the real problem here is that neural
networks suffer from an <em>unstable gradient problem</em>.  As a
result, if we use standard gradient-based learning techniques,
different layers in the network will tend to learn at wildly different
speeds.</p><p></p><h4><a name="exercise_255808"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#exercise_255808">Exercise</a></h4><ul>
<li> In our discussion of the vanishing gradient problem, we made use
  of the fact that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1244" style="width: 5.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1005.49em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1245"><span class="texatom" id="MathJax-Span-1246"><span class="mrow" id="MathJax-Span-1247"><span class="mo" id="MathJax-Span-1248" style="font-family: MathJax_Main;">|</span></span></span><span class="msup" id="MathJax-Span-1249"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1251" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1252" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1254" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="mo" id="MathJax-Span-1257" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main; padding-left: 0.297em;">&lt;</span><span class="mn" id="MathJax-Span-1259" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-1260"><span class="mrow" id="MathJax-Span-1261"><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1263" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&lt;</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-107">|\sigma'(z)| < 1/4</script>.  Suppose we used a different
  activation function, one whose derivative could be much larger.
  Would that help us avoid the unstable gradient problem?
</li></ul><p></p><p><strong>The prevalence of the vanishing gradient problem:</strong> We've seen
that the gradient can either vanish or explode in the early layers of
a deep network.  In fact, when using sigmoid neurons the gradient will
usually vanish.  To see why, consider again the expression <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1264" style="width: 3.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.34em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1265"><span class="texatom" id="MathJax-Span-1266"><span class="mrow" id="MathJax-Span-1267"><span class="mo" id="MathJax-Span-1268" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1269" style="font-family: MathJax_Math-italic;">w</span><span class="msup" id="MathJax-Span-1270"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1272" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1276"><span class="mrow" id="MathJax-Span-1277"><span class="mo" id="MathJax-Span-1278" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-108">|w
\sigma'(z)|</script>.  To avoid the vanishing gradient problem we need <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1279" style="width: 5.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1005.25em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1280"><span class="texatom" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="mo" id="MathJax-Span-1283" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1284" style="font-family: MathJax_Math-italic;">w</span><span class="msup" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1286" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1290" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1291"><span class="mrow" id="MathJax-Span-1292"><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Main; padding-left: 0.297em;">≥</span><span class="mn" id="MathJax-Span-1295" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-109">|w
\sigma'(z)| \geq 1</script>.  You might think this could happen easily if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1296" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.69em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">w</script>
is very large.  However, it's more difficult than it looks.  The
reason is that the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1299" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.06em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1300"><span class="msup" id="MathJax-Span-1301"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1302" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">\sigma'(z)</script> term also depends on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1307" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.69em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1308"><span class="mi" id="MathJax-Span-1309" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">w</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1310" style="width: 8.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.99em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1311"><span class="msup" id="MathJax-Span-1312"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1315" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1317" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1318" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msup" id="MathJax-Span-1319" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1320" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1322" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1323" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1326" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1327" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">\sigma'(z)
= \sigma'(wa +b)</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1328" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.54em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1329"><span class="mi" id="MathJax-Span-1330" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">a</script> is the input activation.  So when we make
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1331" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.69em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1332"><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">w</script> large, we need to be careful that we're not simultaneously making
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1334" style="width: 4.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.61em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1004.51em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1335"><span class="msup" id="MathJax-Span-1336"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1339" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1340" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1341" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1342" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1343" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-116">\sigma'(wa+b)</script> small.  That turns out to be a considerable
constraint.  The reason is that when we make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1345" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.69em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1346"><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">w</script> large we tend to make
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1348" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1002.94em 2.404em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1349"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1351" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1353" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.148em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">wa+b</script> very large.  Looking at the graph of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1354" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.228em 1000.88em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1355"><span class="msup" id="MathJax-Span-1356"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1357" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-119">\sigma'</script> you can see that
this puts us off in the "wings" of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1359" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.228em 1000.88em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1360"><span class="msup" id="MathJax-Span-1361"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1362" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1363" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-120">\sigma'</script> function, where it
takes very small values.  The only way to avoid this is if the input
activation falls within a fairly narrow range of values (this
qualitative explanation is made quantitative in the first problem
below).  Sometimes that will chance to happen.  More often, though, it
does not happen.  And so in the generic case we have vanishing
gradients.</p><p></p><h4><a name="problems_778071"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#problems_778071">Problems</a></h4><ul>
<li> Consider the product <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1364" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1005.79em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1365"><span class="texatom" id="MathJax-Span-1366"><span class="mrow" id="MathJax-Span-1367"><span class="mo" id="MathJax-Span-1368" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1369" style="font-family: MathJax_Math-italic;">w</span><span class="msup" id="MathJax-Span-1370"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1371" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1372" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1373" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1374" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1377" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1378" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1379"><span class="mrow" id="MathJax-Span-1380"><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-121">|w \sigma'(wa+b)|</script>.  Suppose <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1382" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.7em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1383"><span class="texatom" id="MathJax-Span-1384"><span class="mrow" id="MathJax-Span-1385"><span class="mo" id="MathJax-Span-1386" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">w</span><span class="msup" id="MathJax-Span-1388"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1389" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1391" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1392" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1393" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1394" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1396" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1397"><span class="mrow" id="MathJax-Span-1398"><span class="mo" id="MathJax-Span-1399" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1400" style="font-family: MathJax_Main; padding-left: 0.297em;">≥</span><span class="mn" id="MathJax-Span-1401" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-122">|w
  \sigma'(wa+b)| \geq 1</script>.  (1) Argue that this can only ever occur if
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1402" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.09em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1403"><span class="texatom" id="MathJax-Span-1404"><span class="mrow" id="MathJax-Span-1405"><span class="mo" id="MathJax-Span-1406" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1408"><span class="mrow" id="MathJax-Span-1409"><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1411" style="font-family: MathJax_Main; padding-left: 0.297em;">≥</span><span class="mn" id="MathJax-Span-1412" style="font-family: MathJax_Main; padding-left: 0.297em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-123">|w| \geq 4</script>.  (2) Supposing that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1413" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.09em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1414"><span class="texatom" id="MathJax-Span-1415"><span class="mrow" id="MathJax-Span-1416"><span class="mo" id="MathJax-Span-1417" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1418" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1419"><span class="mrow" id="MathJax-Span-1420"><span class="mo" id="MathJax-Span-1421" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main; padding-left: 0.297em;">≥</span><span class="mn" id="MathJax-Span-1423" style="font-family: MathJax_Main; padding-left: 0.297em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-124">|w| \geq 4</script>, consider the set of
  input activations <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1424" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.54em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1425"><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">a</script> for which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1427" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.7em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1428"><span class="texatom" id="MathJax-Span-1429"><span class="mrow" id="MathJax-Span-1430"><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1432" style="font-family: MathJax_Math-italic;">w</span><span class="msup" id="MathJax-Span-1433"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1436" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1437" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-1438" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1441" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1442"><span class="mrow" id="MathJax-Span-1443"><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1445" style="font-family: MathJax_Main; padding-left: 0.297em;">≥</span><span class="mn" id="MathJax-Span-1446" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-126">|w \sigma'(wa+b)| \geq 1</script>.  Show
  that the set of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1447" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.54em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1448"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">a</script> satisfying that constraint can range over an
  interval no greater in width than
  <a class="displaced_anchor" name="eqtn123"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-123&quot;&gt;&lt;mtext&gt;(123)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1450" style="width: 100%; display: inline-block; min-width: 21.522em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 21.522em;"><span style="position: absolute; clip: rect(2.11em 1015.3em 5.395em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1451"><span class="mtable" id="MathJax-Span-1452" style="min-width: 21.522em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.522em;"><span style="display: inline-block; position: absolute; width: 15.346em; height: 0px; clip: rect(-1.909em 1015.3em 1.375em -999.998em); top: 0em; left: 50%; margin-left: -7.694em;"><span style="position: absolute; clip: rect(2.11em 1015.3em 5.395em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 15.346em; height: 0px;"><span style="position: absolute; clip: rect(2.11em 1015.3em 5.395em -999.998em); top: -4.017em; right: 0em;"><span class="mtd" id="MathJax-Span-1456"><span class="mrow" id="MathJax-Span-1457"><span class="mfrac" id="MathJax-Span-1458"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1459" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1001.18em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-1460"><span class="texatom" id="MathJax-Span-1461"><span class="mrow" id="MathJax-Span-1462"><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1464" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1465"><span class="mrow" id="MathJax-Span-1466"><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.38em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.375em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-1468" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-1469"></span><span class="mrow" id="MathJax-Span-1470"><span class="mo" id="MathJax-Span-1471" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-1472"><span class="mfrac" id="MathJax-Span-1473"><span style="display: inline-block; position: relative; width: 9.022em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.993em 1008.83em 4.512em -999.998em); top: -4.801em; left: 50%; margin-left: -4.458em;"><span class="mrow" id="MathJax-Span-1474"><span class="texatom" id="MathJax-Span-1475"><span class="mrow" id="MathJax-Span-1476"><span class="mo" id="MathJax-Span-1477" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1478" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1479"><span class="mrow" id="MathJax-Span-1480"><span class="mo" id="MathJax-Span-1481" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1482" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1483" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1484" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msqrt" id="MathJax-Span-1485" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 5.051em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1003.92em 4.414em -999.998em); top: -4.017em; left: 0.983em;"><span class="mrow" id="MathJax-Span-1486"><span class="mn" id="MathJax-Span-1487" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main; padding-left: 0.248em;">−</span><span class="mn" id="MathJax-Span-1489" style="font-family: MathJax_Main; padding-left: 0.248em;">4</span><span class="texatom" id="MathJax-Span-1490"><span class="mrow" id="MathJax-Span-1491"><span class="mo" id="MathJax-Span-1492" style="font-family: MathJax_Main;">/</span></span></span><span class="texatom" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="mo" id="MathJax-Span-1495" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1496" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1497"><span class="mrow" id="MathJax-Span-1498"><span class="mo" id="MathJax-Span-1499" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1004.07em 3.924em -999.998em); top: -4.605em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 4.071em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 3.385em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.395em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.885em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 1.375em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 1.865em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 2.404em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 2.895em;">−<span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1001.03em 4.512em -999.998em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1500" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.44em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1501" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1009.02em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.022em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1502" style="font-family: MathJax_Main; padding-left: 0.248em;">−</span><span class="mn" id="MathJax-Span-1503" style="font-family: MathJax_Main; padding-left: 0.248em;">1</span></span><span class="mo" id="MathJax-Span-1504" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-1505" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1002.21em 0.395em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -4.017em; right: 0em;"><span class="mtd" id="mjx-eqn-123"><span class="mrow" id="MathJax-Span-1454"><span class="mtext" id="MathJax-Span-1455" style="font-family: MathJax_Main;">(123)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.297em; border-left: 0px solid; width: 0px; height: 3.152em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-123"><mtext>(123)</mtext></mtd><mtd><mfrac><mn>2</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mi>ln</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msqrt><mn>1</mn><mo>−</mo><mn>4</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></msqrt><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-128">\begin{eqnarray}
    \frac{2}{|w|} \ln\left( \frac{|w|(1+\sqrt{1-4/|w|})}{2}-1\right).
  \tag{123}\end{eqnarray}</script>
  (3) Show numerically that the above expression bounding the width of
  the range is greatest at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;6.9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1506" style="width: 4.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.924em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.88em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1507"><span class="texatom" id="MathJax-Span-1508"><span class="mrow" id="MathJax-Span-1509"><span class="mo" id="MathJax-Span-1510" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1511" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"><span class="mo" id="MathJax-Span-1514" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1515" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span><span class="mn" id="MathJax-Span-1516" style="font-family: MathJax_Main; padding-left: 0.297em;">6.9</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≈</mo><mn>6.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-129">|w| \approx 6.9</script>, where it takes a value
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;0.45&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1517" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.846em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1002.8em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1518"><span class="mo" id="MathJax-Span-1519" style="font-family: MathJax_Main;">≈</span><span class="mn" id="MathJax-Span-1520" style="font-family: MathJax_Main; padding-left: 0.297em;">0.45</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≈</mo><mn>0.45</mn></math></span></span><script type="math/tex" id="MathJax-Element-130">\approx 0.45</script>.  And so even given that everything lines up just
  perfectly, we still have a fairly narrow range of input activations
  which can avoid the vanishing gradient problem.<p></p><p></p></li><li><strong>Identity neuron:</strong> <a id="identity_neuron"></a> Consider a
  neuron with a single input, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1521" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1000.54em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1522"><span class="mi" id="MathJax-Span-1523" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.552em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">x</script>, a corresponding weight, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1524" style="width: 1.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1001.13em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1525"><span class="msubsup" id="MathJax-Span-1526"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1527" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1528" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">w_1</script>, a
  bias <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1529" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.44em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1530"><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">b</script>, and a weight <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1532" style="width: 1.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.522em 1001.13em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1533"><span class="msubsup" id="MathJax-Span-1534"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1535" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1536" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">w_2</script> on the output.  Show that by choosing
  the weights and bias appropriately, we can ensure <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1537" style="width: 7.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.846em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1007.8em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1538"><span class="msubsup" id="MathJax-Span-1539"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1540" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1541" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1542" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1543" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1544"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-1546" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1547" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1549" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1550" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1551" style="font-family: MathJax_Main; padding-left: 0.297em;">≈</span><span class="mi" id="MathJax-Span-1552" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>2</mn></msub><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>≈</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">w_2 \sigma(w_1
  x+b) \approx x</script> for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1553" style="width: 3.924em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.826em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1003.73em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1554"><span class="mi" id="MathJax-Span-1555" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1556" style="font-family: MathJax_Main; padding-left: 0.297em;">∈</span><span class="mo" id="MathJax-Span-1557" style="font-family: MathJax_Main; padding-left: 0.297em;">[</span><span class="mn" id="MathJax-Span-1558" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1559" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1560" style="font-family: MathJax_Main; padding-left: 0.15em;">1</span><span class="mo" id="MathJax-Span-1561" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.103em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-136">x \in [0, 1]</script>.  Such a neuron can thus be used
  as a kind of identity neuron, that is, a neuron whose output is the
  same (up to rescaling by a weight factor) as its input.  <em>Hint:
    It helps to rewrite <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1562" style="width: 5.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.531em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.3em 1005.48em 2.599em -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1563"><span class="mi" id="MathJax-Span-1564" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1565" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1566" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span><span class="texatom" id="MathJax-Span-1567"><span class="mrow" id="MathJax-Span-1568"><span class="mo" id="MathJax-Span-1569" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1570" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1571" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Main; padding-left: 0.243em;">Δ</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mi mathvariant="normal">Δ</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">x = 1/2+\Delta</script>, to assume <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1573" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.589em 1001.16em 2.454em -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1574"><span class="msubsup" id="MathJax-Span-1575"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.416em 1000.67em 4.137em -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1576" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.724em;"><span class="mn" id="MathJax-Span-1577" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 0.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-138">w_1</script> is small,
    and to use a Taylor series expansion in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1578" style="width: 2.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.349em 1001.97em 2.502em -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1579"><span class="msubsup" id="MathJax-Span-1580"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.416em 1000.67em 4.137em -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1581" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.724em;"><span class="mn" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mi" id="MathJax-Span-1583" style="font-family: MathJax_Main;">Δ</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub><mi mathvariant="normal">Δ</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">w_1 \Delta</script>.</em>
</li></ul><p></p><p></p><h3><a name="unstable_gradients_in_more_complex_networks"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#unstable_gradients_in_more_complex_networks">Unstable gradients in more complex networks</a></h3><p></p><p>We've been studying toy networks, with just one neuron in each hidden
layer.  What about more complex deep networks, with many neurons in
each hidden layer?</p><p></p><center>
<img src="./chap05_files/tikz40.png">
</center><p></p><p>In fact, much the same behaviour occurs in such networks.  In the
earlier chapter on backpropagation we saw that the gradient in the
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1584" style="width: 0.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.25em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1585"><span class="mi" id="MathJax-Span-1586" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">l</script>th layer of an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1587" style="width: 0.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.689em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.64em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1588"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">L</script> layer network
<a href="http://neuralnetworksanddeeplearning.com/chap2.html#alternative_backprop">is given by</a>:</p><p><a class="displaced_anchor" name="eqtn124"></a><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-124&quot;&gt;&lt;mtext&gt;(124)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1590" style="width: 100%; display: inline-block; min-width: 27.257em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 27.257em;"><span style="position: absolute; clip: rect(3.042em 1021.08em 4.512em -999.998em); top: -4.017em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1591"><span class="mtable" id="MathJax-Span-1592" style="min-width: 27.257em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.257em;"><span style="display: inline-block; position: absolute; width: 21.081em; height: 0px; clip: rect(-0.978em 1021.08em 0.493em -999.998em); top: 0em; left: 50%; margin-left: -10.537em;"><span style="position: absolute; clip: rect(3.042em 1021.08em 4.512em -999.998em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 21.081em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1021.08em 4.414em -999.998em); top: -3.919em; right: 0em;"><span class="mtd" id="MathJax-Span-1596"><span class="mrow" id="MathJax-Span-1597"><span class="msubsup" id="MathJax-Span-1598"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.44em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1599" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1601" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msup" id="MathJax-Span-1602" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1605" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1606"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1607" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-1608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1609" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1610" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1613"><span class="mrow" id="MathJax-Span-1614"><span class="mi" id="MathJax-Span-1615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1617" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1618"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.3em 4.414em -999.998em); top: -4.017em; left: 0em;"><span class="mo" id="MathJax-Span-1619" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.395em;"><span class="mi" id="MathJax-Span-1620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1621"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1622" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-1623" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1624" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1626" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="texatom" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1632" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1634"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1635" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1636"><span class="mrow" id="MathJax-Span-1637"><span class="mi" id="MathJax-Span-1638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1639" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1640" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.3em 4.414em -999.998em); top: -4.017em; left: 0em;"><span class="mo" id="MathJax-Span-1642" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.395em;"><span class="mi" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1644" style="font-family: MathJax_Main; padding-left: 0.15em;">…</span><span class="msup" id="MathJax-Span-1645" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1646" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-1647" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1648" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1649"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-1651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1652" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1653"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.79em 4.218em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1654" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mi" id="MathJax-Span-1655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.831em 1002.21em 0.493em -999.998em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.14em 1002.21em 4.414em -999.998em); top: -3.919em; right: 0em;"><span class="mtd" id="mjx-eqn-124"><span class="mrow" id="MathJax-Span-1594"><span class="mtext" id="MathJax-Span-1595" style="font-family: MathJax_Main;">(124)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.398em; border-left: 0px solid; width: 0px; height: 1.302em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-124"><mtext>(124)</mtext></mtd><mtd><msup><mi>δ</mi><mi>l</mi></msup><mo>=</mo><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>l</mi></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>…</mo><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>L</mi></msup><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mi>a</mi></msub><mi>C</mi></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-142">\begin{eqnarray}
  \delta^l = \Sigma'(z^l) (w^{l+1})^T \Sigma'(z^{l+1}) (w^{l+2})^T \ldots
  \Sigma'(z^L) \nabla_a C
\tag{124}\end{eqnarray}</script></p><p>Here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1657" style="width: 2.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1002.45em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1658"><span class="msup" id="MathJax-Span-1659"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1660" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-1661" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1662" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1663"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1664" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1665" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1666" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.252em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>l</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-143">\Sigma'(z^l)</script> is a diagonal matrix whose entries are the
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1667" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.06em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1668"><span class="msup" id="MathJax-Span-1669"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.59em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1670" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1672" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-144">\sigma'(z)</script> values for the weighted inputs to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1675" style="width: 0.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.25em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1676"><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">l</script>th layer.  The
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1678" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.13em 1000.98em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1679"><span class="msubsup" id="MathJax-Span-1680"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1681" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mi>l</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-146">w^l</script> are the weight matrices for the different layers.  And <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1683" style="width: 2.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.061em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1002.06em 2.404em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1684"><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.79em 4.218em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1686" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mi" id="MathJax-Span-1687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1688" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.198em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>a</mi></msub><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">\nabla_a
C</script> is the vector of partial derivatives of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1689" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.277em 1000.79em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1690"><span class="mi" id="MathJax-Span-1691" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.853em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">C</script> with respect to the
output activations.</p><p>This is a much more complicated expression than in the single-neuron
case.  Still, if you look closely, the essential form is very similar,
with lots of pairs of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1692" style="width: 5.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.1em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1005em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1693"><span class="mo" id="MathJax-Span-1694" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1695"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1696" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1698"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.3em 4.414em -999.998em); top: -4.017em; left: 0em;"><span class="mo" id="MathJax-Span-1699" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mi" id="MathJax-Span-1700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1701"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1702" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1704" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1708" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>w</mi><mi>j</mi></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>j</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-149">(w^j)^T \Sigma'(z^j)</script>.  What's more,
the matrices <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1709" style="width: 2.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1002.55em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1710"><span class="msup" id="MathJax-Span-1711"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1712" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-1713" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1714" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1715"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1716" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1717" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1718" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>j</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-150">\Sigma'(z^j)</script> have small entries on the diagonal, none
larger than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1719" style="width: 0.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.689em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.081em 1000.69em 2.65em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1720"><span class="mfrac" id="MathJax-Span-1721"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.3em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.35em 4.169em -999.998em); top: -3.625em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.49em 1.228em -999.998em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.493em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.447em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-151">\frac{1}{4}</script>. Provided the weight matrices <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1724" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.13em 1001.08em 2.257em -999.998em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1725"><span class="msubsup" id="MathJax-Span-1726"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.11em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mi>j</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-152">w^j</script> aren't
too large, each additional term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1729" style="width: 5.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.179em 1004.9em 2.551em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1730"><span class="mo" id="MathJax-Span-1731" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1732"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1733" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1735"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.3em 4.414em -999.998em); top: -4.017em; left: 0em;"><span class="mo" id="MathJax-Span-1736" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mi" id="MathJax-Span-1737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-1738"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.69em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1739" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-1740" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1741" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1742"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.49em 4.169em -999.998em); top: -4.017em; left: 0em;"><span class="mi" id="MathJax-Span-1743" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1745" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.297em; border-left: 0px solid; width: 0px; height: 1.252em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>w</mi><mi>j</mi></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi mathvariant="normal">Σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mi>l</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">(w^j)^T \Sigma'(z^l)</script> tends to make
the gradient vector smaller, leading to a vanishing gradient.  More
generally, the large number of terms in the product tends to lead to
an unstable gradient, just as in our earlier example.  In practice,
empirically it is typically found in sigmoid networks that gradients
vanish exponentially quickly in earlier layers.  As a result, learning
slows down in those layers.  This slowdown isn't merely an accident or
an inconvenience: it's a fundamental consequence of the approach we're
taking to learning.</p><p></p><h3><a name="other_obstacles_to_deep_learning"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#other_obstacles_to_deep_learning">Other obstacles to deep learning</a></h3><p></p><p>In this chapter we've focused on vanishing gradients - and, more
generally, unstable gradients - as an obstacle to deep learning.  In
fact, unstable gradients are just one obstacle to deep learning,
albeit an important fundamental obstacle.  Much ongoing research aims
to better understand the challenges that can occur when training deep
networks.  I won't comprehensively summarize that work here, but just
want to briefly mention a couple of papers, to give you the flavor of
some of the questions people are asking.</p><p>As a first example, in 2010 Glorot and
Bengio*<span class="marginnote">
*<a href="http://jmlr.org/proceedings/papers/v9/glorot10a/glorot10a.pdf">Understanding
    the difficulty of training deep feedforward neural networks</a>, by
  Xavier Glorot and Yoshua Bengio (2010). See also the earlier
  discussion of the use of sigmoids in
  <a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">Efficient
    BackProp</a>, by Yann LeCun, Léon Bottou,
  Genevieve Orr and Klaus-Robert Müller (1998).</span>
found evidence suggesting that the use of sigmoid activation functions
can cause problems training deep networks.  In particular, they found
evidence that the use of sigmoids will cause the activations in the
final hidden layer to saturate near <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1746" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(1.326em 1000.44em 2.306em -999.998em); top: -2.154em; left: 0em;"><span class="mrow" id="MathJax-Span-1747"><span class="mn" id="MathJax-Span-1748" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.159em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-154">0</script> early in training,
substantially slowing down learning.  They suggested some alternative
activation functions, which appear not to suffer as much from this
saturation problem.</p><p>As a second example, in 2013 Sutskever, Martens, Dahl and
Hinton*<span class="marginnote">
*<a href="http://www.cs.toronto.edu/~hinton/absps/momentum.pdf">On
    the importance of initialization and momentum in deep learning</a>,
  by Ilya Sutskever, James Martens, George Dahl and Geoffrey Hinton
  (2013).</span> studied the impact on deep learning of both the random
weight initialization and the momentum schedule in momentum-based
stochastic gradient descent.  In both cases, making good choices made
a substantial difference in the ability to train deep networks.</p><p>These examples suggest that "What makes deep networks hard to
train?" is a complex question.  In this chapter, we've focused on the
instabilities associated to gradient-based learning in deep networks.
The results in the last two paragraphs suggest that there is also a
role played by the choice of activation function, the way weights are
initialized, and even details of how learning by gradient descent is
implemented.  And, of course, choice of network architecture and other
hyper-parameters is also important. Thus, many factors can play a role
in making deep networks hard to train, and understanding all those
factors is still a subject of ongoing research.  This all seems rather
downbeat and pessimism-inducing.  But the good news is that in the
next chapter we'll turn that around, and develop several approaches to
deep learning that to some extent manage to overcome or route around
all these challenges.</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><script src="./chap05_files/misc.js.download" type="text/javascript"></script>
<script src="./chap05_files/canvas.js.download" type="text/javascript"></script>
<script src="./chap05_files/neuron.js.download" type="text/javascript"></script>
<script src="./chap05_files/chap5.js.download" type="text/javascript"></script></p><p></p></div><div class="footer"> <span class="left_footer"> In academic work,
please cite this book as: Michael A. Nielsen, "Neural Networks and
Deep Learning", Determination Press, 2015

<br>
<br>

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB" style="color: #eee;">Creative Commons Attribution-NonCommercial 3.0
Unported License</a>.  This means you're free to copy, share, and
build on this book, but not to sell it.  If you're interested in
commercial use, please <a href="mailto:mn@michaelnielsen.org">contact me</a>.
</span>
<span class="right_footer">
Last update: Fri Jan 22 14:09:50 2016
<br>
<br>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB"><img alt="Creative Commons Licence" style="border-width:0" src="./chap05_files/88x31.png"></a>
</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44208967-1', 'neuralnetworksanddeeplearning.com');
  ga('send', 'pageview');

</script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>